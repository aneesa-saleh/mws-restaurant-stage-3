"use strict";function _objectWithoutProperties(e,t){if(null==e)return{};var r,a,n=_objectWithoutPropertiesLoose(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],0<=t.indexOf(r)||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function _objectWithoutPropertiesLoose(e,t){if(null==e)return{};var r,a,n={},o=Object.keys(e);for(a=0;a<o.length;a++)r=o[a],0<=t.indexOf(r)||(n[r]=e[r]);return n}var restaurant,reviews,outboxReviews,newMap,previouslyConnected,matchesMediaQuery=!0,mediaQuery="(min-width: 800px)";document.addEventListener("DOMContentLoaded",function(e){previouslyConnected=navigator.onLine,initMap(),updateRestaurantContainerAria(),registerServiceWorker(),window.caches&&setInterval(cleanMapboxTilesCache,5e3),navigator.serviceWorker&&navigator.serviceWorker.addEventListener("message",function(e){var t=e.data,r=t.type,a=t.requestId,n=t.review,o=t.error;"update-review"===r&&(o?(enqueueToast("An error occurred while submitting your review","error"),updateReviewHTML(!0,a)):(enqueueToast("".concat(n.name,"'s review has been saved"),"success"),updateReviewHTML(!1,a,n)))}),"onLine"in navigator&&(window.addEventListener("online",showConnectionStatus),window.addEventListener("offline",showConnectionStatus),showConnectionStatus());document.getElementById("toast")});var initMap=function(){fetchRestaurantFromURL(function(e,t){e?console.error(e):(self.newMap=L.map("map",{center:[t.latlng.lat,t.latlng.lng],zoom:16,scrollWheelZoom:!1}),L.tileLayer("https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.jpg70?access_token={mapboxToken}",{mapboxToken:"pk.eyJ1IjoiYW5lZXNhLXNhbGVoIiwiYSI6ImNqa2xmZHVwMDFoYW4zdnAwYWplMm53bHEifQ.V11dDOtEnWSwTxY-C8mJLw",maxZoom:18,attribution:'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',id:"mapbox.streets"}).addTo(newMap),fillBreadcrumb(),DBHelper.mapMarkerForRestaurant(self.restaurant,self.newMap))})};window.addEventListener("resize",function(){if(window.matchMedia){var e=window.matchMedia(mediaQuery).matches;e!==matchesMediaQuery&&(matchesMediaQuery=e,updateRestaurantContainerAria())}});var previouslyFocusedElement,updateRestaurantContainerAria=function(){var e=document.getElementById("restaurant-container"),t=document.getElementById("accessible-restaurant-container");matchesMediaQuery?(e.setAttribute("aria-hidden","true"),t.setAttribute("aria-hidden","false")):(e.setAttribute("aria-hidden","false"),t.setAttribute("aria-hidden","true"))},fetchRestaurantFromURL=function(r){if(self.restaurant)r(null,self.restaurant);else{var a=getUrlParam("id");if(a)DBHelper.fetchRestaurantById(a,function(e,t){if(!(self.restaurant=t))return document.getElementById("main-spinner").classList.remove("show"),void document.getElementById("main-error").classList.add("show");fetchReviews(a),fillRestaurantHTML(),document.getElementById("main-spinner").classList.remove("show"),document.getElementById("wrap-main-content").classList.remove("hide"),r(null,t)});else{r("No restaurant id in URL",null),document.getElementById("main-spinner").classList.remove("show"),document.getElementById("main-error").classList.add("show")}}},fillRestaurantHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant;document.getElementById("restaurant-name").innerHTML=e.name,document.getElementById("restaurant-address").innerHTML+=e.address;var t=document.getElementById("restaurant-picture"),r=document.createElement("source");r.media="(min-width: 800px)",r.srcset=DBHelper.imageUrlForRestaurant(e,{size:"large",wide:!0}),r.type="image/jpeg",t.appendChild(r);var a=document.createElement("source");a.media="(min-width: 600px)",a.srcset=DBHelper.imageUrlForRestaurant(e,{size:"medium"}),a.type="image/jpeg",t.appendChild(a);var n=document.createElement("source");n.srcset=DBHelper.imageUrlForRestaurant(e,{size:"small"}),n.type="image/jpeg",t.appendChild(n);var o=document.createElement("img");o.className="restaurant-img",o.src=DBHelper.imageUrlForRestaurant(e),o.alt=e.alt,t.appendChild(o),document.getElementById("accessible-restaurant-img").setAttribute("aria-label",e.alt),document.getElementById("restaurant-cuisine").innerHTML="Cuisine: ".concat(e.cuisine_type),document.getElementById("accessible-restaurant-cuisine").innerHTML="Cuisine: ".concat(e.cuisine_type);var i=document.getElementById("add-review-button");i.setAttribute("aria-label","Add a review for ".concat(e.name)),i.removeAttribute("disabled"),document.getElementById("add-review-overlay-heading").innerHTML="Add review for ".concat(e.name),e.operating_hours&&fillRestaurantHoursHTML(),Object.hasOwnProperty.call(e,"is_favorite")&&fillMarkAsFavouriteHTML()},fillRestaurantHoursHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant.operating_hours,t=document.getElementById("restaurant-hours");for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=document.createElement("tr"),n=document.createElement("td");n.innerHTML=r,a.appendChild(n);var o=document.createElement("td");o.innerHTML=e[r],a.appendChild(o),t.appendChild(a)}},markRestaurantAsFavourite=function(e){var t=e.querySelector("i");e.querySelector("span").innerHTML="Unmark restaurant as favourite",t.classList.add("fas","marked"),t.classList.remove("far","unmarked"),t.setAttribute("aria-label","Restaurant is currently marked as favourite")},unmarkRestaurantAsFavourite=function(e){var t=e.querySelector("i");e.querySelector("span").innerHTML="Mark restaurant as favourite",t.classList.add("far","unmarked"),t.classList.remove("fas","marked"),t.setAttribute("aria-label","Restaurant is not currently marked as favourite")},fillMarkAsFavouriteHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant.is_favorite,t=document.getElementById("mark-as-favourite");stringToBoolean(e)?markRestaurantAsFavourite(t):unmarkRestaurantAsFavourite(t)},fetchReviews=function(r){DBHelper.fetchReviewsByRestaurantId(r,function(e,t){(self.reviews=t)?(fillReviewsHTML(),DBHelper.getOutboxReviews(r,function(e,t){e?console.log(e):(self.outboxReviews=t,fillSendingReviewsHTML())})):console.error(e)})},fillReviewsHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.reviews;if(!e||0===e.length){var t=document.createElement("p");return t.innerHTML="No reviews yet!",void container.appendChild(t)}var r=document.getElementById("reviews-list");e.forEach(function(e){r.insertBefore(createReviewHTML(e),r.firstChild)})},fillSendingReviewsHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.outboxReviews;if(e&&0!==e.length){var a=document.getElementById("reviews-list");e.forEach(function(e){var t=e.request_id,r=_objectWithoutProperties(e,["request_id"]);a.insertBefore(createReviewHTML(r,!0,t),a.firstChild)})}},createReviewHTML=function(e,t,r){var a=document.createElement("article");a.className="review";var n=document.createElement("span");n.className="review-header";var o=document.createElement("p");o.innerHTML=e.name,o.className="review-name",n.appendChild(o);var i=document.createElement("p");if(t){var s=document.createElement("i");s.classList.add("far","fa-clock");var u=document.createElement("span");u.innerHTML="Sending",i.appendChild(s),i.appendChild(u)}else{var c=formatDate(new Date(e.updatedAt));i.innerHTML=c}i.className="review-date",n.appendChild(i),a.appendChild(n);var d=document.createElement("span");d.className="review-content";var l=document.createElement("p");l.innerHTML="Rating: ".concat(e.rating),l.className="review-rating",d.appendChild(l);var m=document.createElement("p");return m.innerHTML=e.comments,d.appendChild(m),a.appendChild(d),t&&(a.setAttribute("data-id",r),a.setAttribute("aria-busy","true"),a.classList.add("sending")),a},updateReviewHTML=function(e,t,r){var a=document.querySelector('[data-id="'.concat(t,'"]'));if(e){if(a){var n=a.querySelector(".review-date");n.innerHTML="";var o=document.createElement("i");o.classList.add("fas","fa-exclamation-triangle");var i=document.createElement("span");i.innerHTML="Sending failed",n.appendChild(o),n.appendChild(i),n.classList.add("error")}}else if(document.getElementById("reviews-list")&&self.restaurant)if(a){a.classList.remove("sending");var s=a.querySelector(".review-date"),u=formatDate(new Date(r.updatedAt));s.innerHTML=u}else createReviewHTML(r,!1)},fillBreadcrumb=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant,t=document.getElementById("breadcrumb"),r=document.createElement("li");r.innerHTML=e.name,t.appendChild(r)},getUrlParam=function(e,t){t=t||window.location.href,e=e.replace(/[\[\]]/g,"\\$&");var r=new RegExp("[?&]".concat(e,"(=([^&#]*)|&|#|$)")).exec(t);return r?r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):"":null},setMarkAsFavouriteFetchingState=function(e,t){e.setAttribute("disabled",!0),e.setAttribute("aria-busy","true"),t.classList.add("show")},removeMarkAsFavouriteFetchingState=function(e,t){e.removeAttribute("disabled"),e.setAttribute("aria-busy","false"),t.classList.remove("show")},toggleRestaurantAsFavourite=function(){var r,a,n,e=stringToBoolean(self.restaurant.is_favorite),t=!e&&"false"!==e,o=self.restaurant.id,i=document.getElementById("mark-as-favourite"),s=document.getElementById("favourite-spinner");n=t?(markRestaurantAsFavourite(i),r=unmarkRestaurantAsFavourite,a="Restaurant has been marked as favourite","An error occurred marking restaurant as favourite"):(unmarkRestaurantAsFavourite(i),r=markRestaurantAsFavourite,a="Restaurant has been unmarked as favourite","An error occurred unmarking restaurant as favourite"),setMarkAsFavouriteFetchingState(i,s),DBHelper.setRestaurantFavouriteStatus(o,t,function(e,t){if(removeMarkAsFavouriteFetchingState(i,s),!t)return console.error(e),r(i),void enqueueToast(n,"error");self.restaurant=t,enqueueToast(a,"success")})};function showConnectionStatus(){document.getElementById("connectionStatus");navigator.onLine&&!previouslyConnected?enqueueToast("You are back online","success"):!navigator.onLine&&previouslyConnected&&enqueueToast("You are offline","error"),previouslyConnected=navigator.onLine}function openModal(){previouslyFocusedElement=document.activeElement;var e=document.querySelector(".overlay"),t=e.querySelectorAll("button, input, textarea");e.classList.add("show"),document.body.classList.add("has-open-modal"),document.addEventListener("keydown",trapTabKey),setTimeout(function(){t[0].focus()},100)}function closeModal(){clearFormErrors(),document.querySelector(".overlay").classList.remove("show"),document.body.classList.remove("has-open-modal"),document.removeEventListener("keydown",trapTabKey),previouslyFocusedElement&&previouslyFocusedElement.focus()}function trapTabKey(e){var t=document.querySelector(".overlay").querySelectorAll("button, input"),r=t[0],a=t[t.length-1];e.key&&"Tab"===e.key&&(e.shiftKey&&e.target===r?(e.preventDefault(),a.focus()):e.shiftKey||e.target!==a||(e.preventDefault(),r.focus()))}function setNameInputError(){var e=document.getElementById("name"),t=document.getElementById("name-error");e.classList.add("has-error"),e.setAttribute("aria-invalid","true"),e.setAttribute("aria-describedby","name-error"),t.classList.add("show")}function clearNameInputError(){var e=document.getElementById("name"),t=document.getElementById("name-error");e.classList.remove("has-error"),e.removeAttribute("aria-invalid"),e.removeAttribute("aria-describedby"),t.classList.remove("show")}function setRatingInputError(){var e=document.getElementById("rating"),t=document.getElementById("rating-error");e.classList.add("has-error"),e.setAttribute("aria-invalid","true"),e.setAttribute("aria-describedby","rating-error"),t.classList.add("show")}function clearRatingInputError(){var e=document.getElementById("rating"),t=document.getElementById("rating-error");e.classList.remove("has-error"),e.removeAttribute("aria-invalid"),e.removeAttribute("aria-describedby"),t.classList.remove("show")}function setCommentInputError(){var e=document.getElementById("comments"),t=document.getElementById("comments-error");e.classList.add("has-error"),e.setAttribute("aria-invalid","true"),e.setAttribute("aria-describedby","comments-error"),t.classList.add("show")}function clearCommentInputError(){var e=document.getElementById("comments"),t=document.getElementById("comments-error");e.classList.remove("has-error"),e.removeAttribute("aria-invalid"),e.removeAttribute("aria-describedby"),t.classList.remove("show")}var errorFunctions={name:{setError:setNameInputError,clearError:clearNameInputError},rating:{setError:setRatingInputError,clearError:clearRatingInputError},comments:{setError:setCommentInputError,clearError:clearCommentInputError}};function validateInput(e,t){var r,a=document.getElementById(e).cloneNode();return r=void 0!==t?t:a.value,(r="rating"===e?Number.parseInt(r,10):r)?(errorFunctions[e].clearError(),!0):(requestAnimationFrame(errorFunctions[e].setError),!1)}function validateAllInputs(){var t=!1,r=[];return["name","rating","comments"].forEach(function(e){validateInput(e)||(r.push(e),t=!0)}),{error:t,invalidInputs:r}}function handleRangeChange(e){document.querySelector(".rating-value").innerHTML="".concat(e.target.value,"/5"),validateInput(e.target.name,e.target.value)}function handleInputKeyUp(e){e.key&&"Tab"===e.key||validateInput(e.target.name,e.target.value)}function handleInputBlur(e){validateInput(e.target.name,e.target.value)}function getFormInputValues(){var t={};return["name","rating","comments"].forEach(function(e){t[e]=document.getElementById(e).value}),t}function clearForm(){document.getElementById("name").value="",document.getElementById("rating").value="0",document.querySelector(".rating-value").innerHTML="0/5",document.getElementById("comments").value=""}function clearFormErrors(){document.getElementById("name-error").classList.remove("show"),document.getElementById("rating-error").classList.remove("show"),document.getElementById("comments-error").classList.remove("show"),document.getElementById("add-review-form-error").classList.remove("show"),document.getElementById("add-review-form-error").innerHTML="",document.getElementById("name").classList.remove("has-error"),document.getElementById("rating").classList.remove("has-error"),document.getElementById("comments").classList.remove("has-error")}function handleAddReviewSubmit(){var e=validateAllInputs(),t=e.error,r=e.invalidInputs;if(t){var a=document.getElementById("add-review-form-error"),n="Invalid input for: ".concat(r.join(", "));a.innerHTML=n,a.classList.add("show"),document.getElementById(r[0]).focus()}else{var o=getFormInputValues(),i=o.name,s=o.rating,u=o.comments;if(navigator.serviceWorker&&navigator.serviceWorker.controller){var c="".concat(self.restaurant.id,"-").concat(Date.now()),d={name:i,rating:s,comments:u,restaurant_id:self.restaurant.id},l=document.getElementById("reviews-list");l.insertBefore(createReviewHTML(d,!0,c),l.firstChild),"onLine"in navigator&&!navigator.onLine&&enqueueToast("Your review will be submitted when you are back online"),closeModal(),clearForm(),navigator.serviceWorker.controller.postMessage({type:"post-review",review:d,requestId:c})}else{var m=document.getElementById("add-review-submit");m.setAttribute("disabled",!0),m.setAttribute("aria-busy","true"),DBHelper.addReview(self.restaurant.id,i,s,u,function(e,t){if(m.removeAttribute("disabled"),m.setAttribute("aria-busy","false"),e)enqueueToast("An error occurred. Please try again","error"),console.log(e);else{enqueueToast("".concat(i,"'s review has been saved"),"success");var r=document.getElementById("reviews-list");r.insertBefore(createReviewHTML(t),r.firstChild),closeModal(),clearForm()}})}}}function handleFormSubmit(e){e.preventDefault()}
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJlc3RhdXJhbnRfaW5mby5qcyIsImFkZFJldmlld01vZGFsLmpzIl0sIm5hbWVzIjpbInJlc3RhdXJhbnQiLCJyZXZpZXdzIiwib3V0Ym94UmV2aWV3cyIsIm5ld01hcCIsIm1hdGNoZXNNZWRpYVF1ZXJ5IiwibWVkaWFRdWVyeSIsImRvY3VtZW50IiwiZXZlbnQiLCJwcmV2aW91c2x5Q29ubmVjdGVkIiwibmF2aWdhdG9yIiwib25MaW5lIiwiaW5pdE1hcCIsIndpbmRvdyIsImNhY2hlcyIsInNldEludGVydmFsIiwiY2xlYW5NYXBib3hUaWxlc0NhY2hlIiwicmVnaXN0ZXJTZXJ2aWNlV29ya2VyIiwic2VydmljZVdvcmtlciIsImFkZEV2ZW50TGlzdGVuZXIiLCJfZXZlbnQkZGF0YSIsImRhdGEiLCJ0eXBlIiwidXBkYXRlUmV2aWV3SFRNTCIsInJlcXVlc3RJZCIsImNvbmNhdCIsInJldmlldyIsIm5hbWUiLCJzaG93Q29ubmVjdGlvblN0YXR1cyIsImVucXVldWVUb2FzdCIsImdldEVsZW1lbnRCeUlkIiwiZmV0Y2hSZXN0YXVyYW50RnJvbVVSTCIsImVycm9yIiwidG9hc3QiLCJjb25zb2xlIiwic2VsZiIsIkwiLCJtYXAiLCJjZW50ZXIiLCJsYXRsbmciLCJsYXQiLCJsbmciLCJ6b29tIiwiTUFQQk9YX0FQSV9LRVkiLCJtYXBib3hUb2tlbiIsImF0dHJpYnV0aW9uIiwic2Nyb2xsV2hlZWxab29tIiwiZmlsbEJyZWFkY3J1bWIiLCJEQkhlbHBlciIsIm1hcE1hcmtlckZvclJlc3RhdXJhbnQiLCJuZXh0TWF0Y2hlc01lZGlhUXVlcnkiLCJtYXRjaE1lZGlhIiwibWF0Y2hlcyIsInVwZGF0ZVJlc3RhdXJhbnRDb250YWluZXJBcmlhIiwicHJldmlvdXNseUZvY3VzZWRFbGVtZW50IiwicmVzdGF1cmFudENvbnRhaW5lciIsInNldEF0dHJpYnV0ZSIsImFjY2Vzc2libGVSZXN0YXVyYW50Q29udGFpbmVyIiwiY2FsbGJhY2siLCJpZCIsImdldFVybFBhcmFtIiwiZmV0Y2hSZXN0YXVyYW50QnlJZCIsImNsYXNzTGlzdCIsInJlbW92ZSIsImZpbGxSZXN0YXVyYW50SFRNTCIsImFkZCIsImFyZ3VtZW50cyIsImxlbmd0aCIsInVuZGVmaW5lZCIsImFkZHJlc3MiLCJwaWN0dXJlIiwic291cmNlTGFyZ2UiLCJjcmVhdGVFbGVtZW50IiwiZmV0Y2hSZXZpZXdzIiwiaW1hZ2VVcmxGb3JSZXN0YXVyYW50Iiwic2l6ZSIsIndpZGUiLCJzb3VyY2VNZWRpdW0iLCJtZWRpYSIsInNyY3NldCIsImFwcGVuZENoaWxkIiwic291cmNlU21hbGwiLCJpbm5lckhUTUwiLCJpbWFnZSIsImFsdCIsImN1aXNpbmVfdHlwZSIsImFkZFJldmlld0J1dHRvbiIsImZpbGxSZXN0YXVyYW50SG91cnNIVE1MIiwiaGFzT3duUHJvcGVydHkiLCJhY2Nlc3NpYmxlUmVzdGF1cmFudEN1aXNpbmUiLCJyZW1vdmVBdHRyaWJ1dGUiLCJjYWxsIiwib3BlcmF0aW5nSG91cnMiLCJrZXkiLCJhZGRSZXZpZXdPdmVybGF5SGVhZGluZyIsImRheSIsIm9wZXJhdGluZ19ob3VycyIsInRpbWUiLCJPYmplY3QiLCJmaWxsTWFya0FzRmF2b3VyaXRlSFRNTCIsImhvdXJzIiwicm93IiwibWFya1Jlc3RhdXJhbnRBc0Zhdm91cml0ZSIsImJ1dHRvbiIsInF1ZXJ5U2VsZWN0b3IiLCJpY29uIiwicHJvdG90eXBlIiwidGV4dCIsImlzRmF2b3VyaXRlIiwiaXNfZmF2b3JpdGUiLCJzdHJpbmdUb0Jvb2xlYW4iLCJmYXZvdXJpdGVCdXR0b24iLCJ1bm1hcmtSZXN0YXVyYW50QXNGYXZvdXJpdGUiLCJmaWxsUmV2aWV3c0hUTUwiLCJub1Jldmlld3MiLCJmZXRjaFJldmlld3NCeVJlc3RhdXJhbnRJZCIsImNvbnRhaW5lciIsInVsIiwiZm9yRWFjaCIsImluc2VydEJlZm9yZSIsImNyZWF0ZVJldmlld0hUTUwiLCJmaXJzdENoaWxkIiwiZmlsbFNlbmRpbmdSZXZpZXdzSFRNTCIsIm91dGJveFJldmlldyIsInJlcXVlc3RfaWQiLCJfb2JqZWN0V2l0aG91dFByb3BlcnRpZXMiLCJhcnRpY2xlIiwiY2xhc3NOYW1lIiwiaGVhZGVyU3BhbiIsInNlbmRpbmciLCJsb2FkaW5nVGV4dCIsImRhdGUiLCJmb3JtYXREYXRlIiwiRGF0ZSIsImRhdGVUZXh0IiwiY29udGVudFNwYW4iLCJyYXRpbmciLCJjb21tZW50cyIsInJldmlld0VsZW1lbnQiLCJlcnJvclRleHQiLCJ1cGRhdGVkQXQiLCJsaSIsImJyZWFkY3J1bWIiLCJ1cmwiLCJyZXBsYWNlIiwicmVzdWx0cyIsImRlY29kZVVSSUNvbXBvbmVudCIsInNldE1hcmtBc0Zhdm91cml0ZUZldGNoaW5nU3RhdGUiLCJzcGlubmVyIiwicmVtb3ZlTWFya0FzRmF2b3VyaXRlRmV0Y2hpbmdTdGF0ZSIsImZhaWxlZFVwZGF0ZUNhbGxiYWNrIiwic3VjY2Vzc01lc3NhZ2UiLCJlcnJvck1lc3NhZ2UiLCJuZXdJc0Zhdm91cml0ZSIsInJlc3RhdXJhbnRJZCIsInVwZGF0ZWRSZXN0YXVyYW50Iiwib3Blbk1vZGFsIiwiYWN0aXZlRWxlbWVudCIsIm92ZXJsYXkiLCJpbnRlcmFjdGl2ZUVsZW1lbnRzIiwicXVlcnlTZWxlY3RvckFsbCIsImJvZHkiLCJ0cmFwVGFiS2V5Iiwic2V0VGltZW91dCIsImZvY3VzIiwiY2xvc2VNb2RhbCIsImNsZWFyRm9ybUVycm9ycyIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJmaXJzdEVsZW1lbnQiLCJsYXN0RWxlbWVudCIsInNoaWZ0S2V5IiwidGFyZ2V0IiwicHJldmVudERlZmF1bHQiLCJzZXROYW1lSW5wdXRFcnJvciIsIm5hbWVJbnB1dCIsIm5hbWVJbnB1dEVycm9yIiwiY2xlYXJOYW1lSW5wdXRFcnJvciIsInNldFJhdGluZ0lucHV0RXJyb3IiLCJyYXRpbmdJbnB1dCIsInJhdGluZ0lucHV0RXJyb3IiLCJjbGVhclJhdGluZ0lucHV0RXJyb3IiLCJzZXRDb21tZW50SW5wdXRFcnJvciIsImNvbW1lbnRJbnB1dCIsImNvbW1lbnRJbnB1dEVycm9yIiwiY2xlYXJDb21tZW50SW5wdXRFcnJvciIsImVycm9yRnVuY3Rpb25zIiwic2V0RXJyb3IiLCJjbGVhckVycm9yIiwidmFsaWRhdGVJbnB1dCIsInZhbHVlIiwiaW5wdXRWYWx1ZSIsImlucHV0IiwiY2xvbmVOb2RlIiwiTnVtYmVyIiwicGFyc2VJbnQiLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJ2YWxpZGF0ZUFsbElucHV0cyIsImludmFsaWRJbnB1dHMiLCJwdXNoIiwiaGFuZGxlUmFuZ2VDaGFuZ2UiLCJoYW5kbGVJbnB1dEtleVVwIiwiaGFuZGxlSW5wdXRCbHVyIiwiZ2V0Rm9ybUlucHV0VmFsdWVzIiwidmFsdWVzIiwiY2xlYXJGb3JtIiwiaGFuZGxlQWRkUmV2aWV3U3VibWl0IiwiX3ZhbGlkYXRlQWxsSW5wdXRzIiwiZm9ybUVycm9yIiwiam9pbiIsIl9nZXRGb3JtSW5wdXRWYWx1ZXMiLCJjb250cm9sbGVyIiwibm93IiwibmV3UmV2aWV3IiwicmVzdGF1cmFudF9pZCIsInBvc3RNZXNzYWdlIiwic3VibWl0QnV0dG9uIiwiYWRkUmV2aWV3IiwibG9nIiwiaGFuZGxlRm9ybVN1Ym1pdCJdLCJtYXBwaW5ncyI6Im1kQUFBLElBQUlBLFdBQ0FDLFFBQ0FDLGNBQ0FDLE9BSEFILG9CQUlBSSxtQkFBb0IsRUFDbEJDLFdBQWEscUJBQW5CQyxTQUFNRCxpQkFBYSxtQkFBbkIsU0FBQUUsR0FDQUMsb0JBQUFDLFVBQUFDLE9BUUVDLFVBRkFILGdDQUVBRyx3QkFHQUMsT0FBQUMsUUFLRUMsWUFBWUMsc0JBQXVCLEtBSHJDQyxVQUFBQSxlQU9FUCxVQUFVUSxjQUFjQyxpQkFBaUIsVUFBVyxTQUFDWCxHQUFVLElBQUFZLEVBSGhFWixFQUFBYSxLQURDTixFQUkrREssRUFKL0RMLEtBQUFBLEVBSStESyxFQUovREwsVUFBWUMsRUFJbURJLEVBSm5ESixPQUFBQSxFQUltREksRUFKbkRKLE1BUUcsa0JBQVRNLElBTEpaLEdBQ0ZBLGFBQVVRLGlEQUFxRCxTQUFBSyxr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VUFBQUEsUUFwQ3FFLENBRXZFLElBQU0rTCxFQUFlaE4sU0FBU3VCLGVBQWUscUJBQzdDeUwsRUFBYS9KLGFBQWEsWUFBWSxHQUN0QytKLEVBQWEvSixhQUFhLFlBQWEsUUFDdkNSLFNBQVN3SyxVQUFVckwsS0FBS2xDLFdBQVcwRCxHQUFJaEMsRUFBTTZHLEVBQVFDLEVBQVUsU0FBQ3pHLEVBQU9vTCxHQUdyRSxHQUZBRyxFQUFhN0gsZ0JBQWdCLFlBQzdCNkgsRUFBYS9KLGFBQWEsWUFBYSxTQUNuQ3hCLEVBQ0ZILGFBQWEsc0NBQXVDLFNBQ3BESyxRQUFRdUwsSUFBSXpMLE9BQ1AsQ0FDTEgsYUFBWSxHQUFBSixPQUFJRSxFQUFKLDRCQUFvQyxXQUNoRCxJQUFNMEYsRUFBSzlHLFNBQVN1QixlQUFlLGdCQUNuQ3VGLEVBQUdFLGFBQWFDLGlCQUFpQjRGLEdBQVkvRixFQUFHSSxZQUNoRDRDLGFBQ0F1QyxpQkFnQ1YsU0FBU2MsaUJBQWlCbE4sR0FDeEJBLEVBQU1vSyIsImZpbGUiOiJyZXN0YXVyYW50X2luZm8uanMiLCJzb3VyY2VzQ29udGVudCI6WyJsZXQgcmVzdGF1cmFudDtcbmxldCByZXZpZXdzO1xubGV0IG91dGJveFJldmlld3M7XG5sZXQgbmV3TWFwO1xubGV0IG1hdGNoZXNNZWRpYVF1ZXJ5ID0gdHJ1ZTtcbmNvbnN0IG1lZGlhUXVlcnkgPSAnKG1pbi13aWR0aDogODAwcHgpJztcbmxldCBwcmV2aW91c2x5Q29ubmVjdGVkO1xuXG4vKipcbiAqIEluaXRpYWxpemUgbWFwIGFzIHNvb24gYXMgdGhlIHBhZ2UgaXMgbG9hZGVkLlxuICovXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgKGV2ZW50KSA9PiB7XG4gIHByZXZpb3VzbHlDb25uZWN0ZWQgPSBuYXZpZ2F0b3Iub25MaW5lO1xuXG4gIGluaXRNYXAoKTtcbiAgLy8gaWYgKHdpbmRvdy5tYXRjaE1lZGlhKSB7XG4gIC8vICAgbWF0Y2hlc01lZGlhUXVlcnkgPSB3aW5kb3cubWF0Y2hNZWRpYShtZWRpYVF1ZXJ5KS5tYXRjaGVzO1xuICAvLyB9XG4gIHVwZGF0ZVJlc3RhdXJhbnRDb250YWluZXJBcmlhKCk7IC8vIHNldCBpbml0aWFsIGFyaWEgdmFsdWVzXG4gIHJlZ2lzdGVyU2VydmljZVdvcmtlcigpO1xuXG4gIGlmICh3aW5kb3cuY2FjaGVzKSB7XG4gICAgc2V0SW50ZXJ2YWwoY2xlYW5NYXBib3hUaWxlc0NhY2hlLCA1MDAwKTtcbiAgfVxuXG4gIGlmIChuYXZpZ2F0b3Iuc2VydmljZVdvcmtlcikge1xuICAgIG5hdmlnYXRvci5zZXJ2aWNlV29ya2VyLmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCAoZXZlbnQpID0+IHtcbiAgICAgIGNvbnN0IHtcbiAgICAgICAgdHlwZSwgcmVxdWVzdElkLCByZXZpZXcsIGVycm9yLFxuICAgICAgfSA9IGV2ZW50LmRhdGE7XG4gICAgICBpZiAodHlwZSA9PT0gJ3VwZGF0ZS1yZXZpZXcnKSB7XG4gICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgIGVucXVldWVUb2FzdCgnQW4gZXJyb3Igb2NjdXJyZWQgd2hpbGUgc3VibWl0dGluZyB5b3VyIHJldmlldycsICdlcnJvcicpO1xuICAgICAgICAgIHVwZGF0ZVJldmlld0hUTUwodHJ1ZSwgcmVxdWVzdElkKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBlbnF1ZXVlVG9hc3QoYCR7cmV2aWV3Lm5hbWV9J3MgcmV2aWV3IGhhcyBiZWVuIHNhdmVkYCwgJ3N1Y2Nlc3MnKTtcbiAgICAgICAgICB1cGRhdGVSZXZpZXdIVE1MKGZhbHNlLCByZXF1ZXN0SWQsIHJldmlldyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIGlmICgnb25MaW5lJyBpbiBuYXZpZ2F0b3IpIHtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignb25saW5lJywgc2hvd0Nvbm5lY3Rpb25TdGF0dXMpO1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdvZmZsaW5lJywgc2hvd0Nvbm5lY3Rpb25TdGF0dXMpO1xuICAgIHNob3dDb25uZWN0aW9uU3RhdHVzKCk7XG4gIH1cblxuICBjb25zdCB0b2FzdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0b2FzdCcpO1xufSk7XG5cbi8qKlxuICogSW5pdGlhbGl6ZSBsZWFmbGV0IG1hcFxuICovXG5jb25zdCBpbml0TWFwID0gKCkgPT4ge1xuICBmZXRjaFJlc3RhdXJhbnRGcm9tVVJMKChlcnJvciwgcmVzdGF1cmFudCkgPT4ge1xuICAgIGNvbnN0IE1BUEJPWF9BUElfS0VZID0gJ3BrLmV5SjFJam9pWVc1bFpYTmhMWE5oYkdWb0lpd2lZU0k2SW1OcWEyeG1aSFZ3TURGb1lXNHpkbkF3WVdwbE1tNTNiSEVpZlEuVjExZERPdEVuV1N3VHhZLUM4bUpMdyc7XG4gICAgaWYgKGVycm9yKSB7IC8vIEdvdCBhbiBlcnJvciFcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuICAgIH0gZWxzZSB7XG4gICAgICBzZWxmLm5ld01hcCA9IEwubWFwKCdtYXAnLCB7XG4gICAgICAgIGNlbnRlcjogW3Jlc3RhdXJhbnQubGF0bG5nLmxhdCwgcmVzdGF1cmFudC5sYXRsbmcubG5nXSxcbiAgICAgICAgem9vbTogMTYsXG4gICAgICAgIHNjcm9sbFdoZWVsWm9vbTogZmFsc2UsXG4gICAgICB9KTtcbiAgICAgIEwudGlsZUxheWVyKCdodHRwczovL2FwaS50aWxlcy5tYXBib3guY29tL3Y0L3tpZH0ve3p9L3t4fS97eX0uanBnNzA/YWNjZXNzX3Rva2VuPXttYXBib3hUb2tlbn0nLCB7XG4gICAgICAgIG1hcGJveFRva2VuOiBNQVBCT1hfQVBJX0tFWSxcbiAgICAgICAgbWF4Wm9vbTogMTgsXG4gICAgICAgIGF0dHJpYnV0aW9uOiAnTWFwIGRhdGEgJmNvcHk7IDxhIGhyZWY9XCJodHRwczovL3d3dy5vcGVuc3RyZWV0bWFwLm9yZy9cIj5PcGVuU3RyZWV0TWFwPC9hPiBjb250cmlidXRvcnMsICdcbiAgICAgICAgICArICc8YSBocmVmPVwiaHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LXNhLzIuMC9cIj5DQy1CWS1TQTwvYT4sICdcbiAgICAgICAgICArICdJbWFnZXJ5IMKpIDxhIGhyZWY9XCJodHRwczovL3d3dy5tYXBib3guY29tL1wiPk1hcGJveDwvYT4nLFxuICAgICAgICBpZDogJ21hcGJveC5zdHJlZXRzJyxcbiAgICAgIH0pLmFkZFRvKG5ld01hcCk7XG4gICAgICBmaWxsQnJlYWRjcnVtYigpO1xuICAgICAgREJIZWxwZXIubWFwTWFya2VyRm9yUmVzdGF1cmFudChzZWxmLnJlc3RhdXJhbnQsIHNlbGYubmV3TWFwKTtcbiAgICB9XG4gIH0pO1xufTtcblxuLyoqXG4qIFVwZGF0ZSBhcmlhLWhpZGRlbiB2YWx1ZXMgb2YgdGhlIHZpc2libGUgYW5kIGFjY2Vzc2libGUgcmVzdGF1cmFudCBjb250YWluZXJzXG4qL1xud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsICgpID0+IHtcbiAgaWYgKHdpbmRvdy5tYXRjaE1lZGlhKSB7XG4gICAgY29uc3QgbmV4dE1hdGNoZXNNZWRpYVF1ZXJ5ID0gd2luZG93Lm1hdGNoTWVkaWEobWVkaWFRdWVyeSkubWF0Y2hlcztcbiAgICBpZiAobmV4dE1hdGNoZXNNZWRpYVF1ZXJ5ICE9PSBtYXRjaGVzTWVkaWFRdWVyeSkgeyAvLyBvbmx5IHVwZGF0ZSBhcmlhIHdoZW4gbGF5b3V0IGNoYW5nZXNcbiAgICAgIG1hdGNoZXNNZWRpYVF1ZXJ5ID0gbmV4dE1hdGNoZXNNZWRpYVF1ZXJ5O1xuICAgICAgdXBkYXRlUmVzdGF1cmFudENvbnRhaW5lckFyaWEoKTtcbiAgICB9XG4gIH1cbn0pO1xuXG4vKipcbiogU2V0IGFyaWEtaGlkZGVuIHZhbHVlcyBmb3IgdmlzaWJsZSBhbmQgcmVndWxhciByZXN0YXVyYW50IGNvbnRhaW5lcnNcbiogQWNjZXNzaWJsZSByZXN0YXVyYW50IGNvbnRhaW5lciBpcyBvZmYgc2NyZWVuXG4qIEl0IGlzIHJlcXVpcmVkIHRvIG1haW50YWluIHNjcmVlbiByZWFkaW5nIG9yZGVyIHdoZW4gdGhlIGxheW91dCBzaGlmdHNcbiovXG5jb25zdCB1cGRhdGVSZXN0YXVyYW50Q29udGFpbmVyQXJpYSA9ICgpID0+IHtcbiAgY29uc3QgcmVzdGF1cmFudENvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50LWNvbnRhaW5lcicpO1xuICBjb25zdCBhY2Nlc3NpYmxlUmVzdGF1cmFudENvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhY2Nlc3NpYmxlLXJlc3RhdXJhbnQtY29udGFpbmVyJyk7XG4gIGlmIChtYXRjaGVzTWVkaWFRdWVyeSkgeyAvLyBsYXJnZXIgbGF5b3V0LCBzY3JlZW4gcmVhZGluZyBvcmRlciBvZmZcbiAgICByZXN0YXVyYW50Q29udGFpbmVyLnNldEF0dHJpYnV0ZSgnYXJpYS1oaWRkZW4nLCAndHJ1ZScpO1xuICAgIGFjY2Vzc2libGVSZXN0YXVyYW50Q29udGFpbmVyLnNldEF0dHJpYnV0ZSgnYXJpYS1oaWRkZW4nLCAnZmFsc2UnKTtcbiAgfSBlbHNlIHsgLy8gdXNlIHJlZ3VsYXIgcmVhZGluZyBvcmRlclxuICAgIHJlc3RhdXJhbnRDb250YWluZXIuc2V0QXR0cmlidXRlKCdhcmlhLWhpZGRlbicsICdmYWxzZScpO1xuICAgIGFjY2Vzc2libGVSZXN0YXVyYW50Q29udGFpbmVyLnNldEF0dHJpYnV0ZSgnYXJpYS1oaWRkZW4nLCAndHJ1ZScpO1xuICB9XG59O1xuXG4vKipcbiAqIEdldCBjdXJyZW50IHJlc3RhdXJhbnQgZnJvbSBwYWdlIFVSTC5cbiAqL1xuY29uc3QgZmV0Y2hSZXN0YXVyYW50RnJvbVVSTCA9IChjYWxsYmFjaykgPT4ge1xuICBpZiAoc2VsZi5yZXN0YXVyYW50KSB7IC8vIHJlc3RhdXJhbnQgYWxyZWFkeSBmZXRjaGVkIVxuICAgIGNhbGxiYWNrKG51bGwsIHNlbGYucmVzdGF1cmFudCk7XG4gICAgcmV0dXJuO1xuICB9XG4gIGNvbnN0IGlkID0gZ2V0VXJsUGFyYW0oJ2lkJyk7XG4gIGlmICghaWQpIHsgLy8gbm8gaWQgZm91bmQgaW4gVVJMXG4gICAgY29uc3QgZXJyb3IgPSAnTm8gcmVzdGF1cmFudCBpZCBpbiBVUkwnO1xuICAgIGNhbGxiYWNrKGVycm9yLCBudWxsKTtcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFpbi1zcGlubmVyJykuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpO1xuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYWluLWVycm9yJykuY2xhc3NMaXN0LmFkZCgnc2hvdycpO1xuICB9IGVsc2Uge1xuICAgIERCSGVscGVyLmZldGNoUmVzdGF1cmFudEJ5SWQoaWQsIChlcnJvciwgcmVzdGF1cmFudCkgPT4ge1xuICAgICAgc2VsZi5yZXN0YXVyYW50ID0gcmVzdGF1cmFudDtcbiAgICAgIGlmICghcmVzdGF1cmFudCkge1xuICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFpbi1zcGlubmVyJykuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpO1xuICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFpbi1lcnJvcicpLmNsYXNzTGlzdC5hZGQoJ3Nob3cnKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgZmV0Y2hSZXZpZXdzKGlkKTtcbiAgICAgIGZpbGxSZXN0YXVyYW50SFRNTCgpO1xuICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21haW4tc3Bpbm5lcicpLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKTtcbiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd3cmFwLW1haW4tY29udGVudCcpLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGUnKTtcbiAgICAgIGNhbGxiYWNrKG51bGwsIHJlc3RhdXJhbnQpO1xuICAgIH0pO1xuICB9XG59O1xuXG4vKipcbiAqIENyZWF0ZSByZXN0YXVyYW50IEhUTUwgYW5kIGFkZCBpdCB0byB0aGUgd2VicGFnZVxuICovXG5jb25zdCBmaWxsUmVzdGF1cmFudEhUTUwgPSAocmVzdGF1cmFudCA9IHNlbGYucmVzdGF1cmFudCkgPT4ge1xuICBjb25zdCBuYW1lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnQtbmFtZScpO1xuICBuYW1lLmlubmVySFRNTCA9IHJlc3RhdXJhbnQubmFtZTtcblxuICBjb25zdCBhZGRyZXNzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnQtYWRkcmVzcycpO1xuICBhZGRyZXNzLmlubmVySFRNTCArPSByZXN0YXVyYW50LmFkZHJlc3M7XG5cbiAgY29uc3QgcGljdHVyZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50LXBpY3R1cmUnKTtcblxuICBjb25zdCBzb3VyY2VMYXJnZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NvdXJjZScpO1xuICBzb3VyY2VMYXJnZS5tZWRpYSA9ICcobWluLXdpZHRoOiA4MDBweCknO1xuICBzb3VyY2VMYXJnZS5zcmNzZXQgPSBEQkhlbHBlci5pbWFnZVVybEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCwgeyBzaXplOiAnbGFyZ2UnLCB3aWRlOiB0cnVlIH0pO1xuICBzb3VyY2VMYXJnZS50eXBlID0gJ2ltYWdlL2pwZWcnO1xuICBwaWN0dXJlLmFwcGVuZENoaWxkKHNvdXJjZUxhcmdlKTtcblxuICBjb25zdCBzb3VyY2VNZWRpdW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzb3VyY2UnKTtcbiAgc291cmNlTWVkaXVtLm1lZGlhID0gJyhtaW4td2lkdGg6IDYwMHB4KSc7XG4gIHNvdXJjZU1lZGl1bS5zcmNzZXQgPSBEQkhlbHBlci5pbWFnZVVybEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCwgeyBzaXplOiAnbWVkaXVtJyB9KTtcbiAgc291cmNlTWVkaXVtLnR5cGUgPSAnaW1hZ2UvanBlZyc7XG4gIHBpY3R1cmUuYXBwZW5kQ2hpbGQoc291cmNlTWVkaXVtKTtcblxuICBjb25zdCBzb3VyY2VTbWFsbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NvdXJjZScpO1xuICBzb3VyY2VTbWFsbC5zcmNzZXQgPSBEQkhlbHBlci5pbWFnZVVybEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCwgeyBzaXplOiAnc21hbGwnIH0pO1xuICBzb3VyY2VTbWFsbC50eXBlID0gJ2ltYWdlL2pwZWcnO1xuICBwaWN0dXJlLmFwcGVuZENoaWxkKHNvdXJjZVNtYWxsKTtcblxuICBjb25zdCBpbWFnZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ltZycpO1xuICBpbWFnZS5jbGFzc05hbWUgPSAncmVzdGF1cmFudC1pbWcnO1xuICAvLyBzZXQgZGVmYXVsdCBzaXplIGluIGNhc2UgcGljdHVyZSBlbGVtZW50IGlzIG5vdCBzdXBwb3J0ZWRcbiAgaW1hZ2Uuc3JjID0gREJIZWxwZXIuaW1hZ2VVcmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpO1xuICBpbWFnZS5hbHQgPSByZXN0YXVyYW50LmFsdDtcbiAgcGljdHVyZS5hcHBlbmRDaGlsZChpbWFnZSk7XG5cbiAgY29uc3QgYWNjZXNzaWJsZVJlc3RhdXJhbnRJbWFnZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhY2Nlc3NpYmxlLXJlc3RhdXJhbnQtaW1nJyk7XG4gIGFjY2Vzc2libGVSZXN0YXVyYW50SW1hZ2Uuc2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsJywgcmVzdGF1cmFudC5hbHQpO1xuXG4gIGNvbnN0IGN1aXNpbmUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1jdWlzaW5lJyk7XG4gIGN1aXNpbmUuaW5uZXJIVE1MID0gYEN1aXNpbmU6ICR7cmVzdGF1cmFudC5jdWlzaW5lX3R5cGV9YDtcblxuICBjb25zdCBhY2Nlc3NpYmxlUmVzdGF1cmFudEN1aXNpbmUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYWNjZXNzaWJsZS1yZXN0YXVyYW50LWN1aXNpbmUnKTtcbiAgYWNjZXNzaWJsZVJlc3RhdXJhbnRDdWlzaW5lLmlubmVySFRNTCA9IGBDdWlzaW5lOiAke3Jlc3RhdXJhbnQuY3Vpc2luZV90eXBlfWA7XG5cbiAgY29uc3QgYWRkUmV2aWV3QnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FkZC1yZXZpZXctYnV0dG9uJyk7XG4gIGFkZFJldmlld0J1dHRvbi5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCBgQWRkIGEgcmV2aWV3IGZvciAke3Jlc3RhdXJhbnQubmFtZX1gKTtcbiAgYWRkUmV2aWV3QnV0dG9uLnJlbW92ZUF0dHJpYnV0ZSgnZGlzYWJsZWQnKTtcblxuICBjb25zdCBhZGRSZXZpZXdPdmVybGF5SGVhZGluZyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhZGQtcmV2aWV3LW92ZXJsYXktaGVhZGluZycpO1xuICBhZGRSZXZpZXdPdmVybGF5SGVhZGluZy5pbm5lckhUTUwgPSBgQWRkIHJldmlldyBmb3IgJHtyZXN0YXVyYW50Lm5hbWV9YDtcblxuICAvLyBmaWxsIG9wZXJhdGluZyBob3Vyc1xuICBpZiAocmVzdGF1cmFudC5vcGVyYXRpbmdfaG91cnMpIHtcbiAgICBmaWxsUmVzdGF1cmFudEhvdXJzSFRNTCgpO1xuICB9XG5cbiAgaWYgKE9iamVjdC5oYXNPd25Qcm9wZXJ0eS5jYWxsKHJlc3RhdXJhbnQsICdpc19mYXZvcml0ZScpKSB7XG4gICAgZmlsbE1hcmtBc0Zhdm91cml0ZUhUTUwoKTtcbiAgfVxufTtcblxuLyoqXG4gKiBDcmVhdGUgcmVzdGF1cmFudCBvcGVyYXRpbmcgaG91cnMgSFRNTCB0YWJsZSBhbmQgYWRkIGl0IHRvIHRoZSB3ZWJwYWdlLlxuICovXG5jb25zdCBmaWxsUmVzdGF1cmFudEhvdXJzSFRNTCA9IChvcGVyYXRpbmdIb3VycyA9IHNlbGYucmVzdGF1cmFudC5vcGVyYXRpbmdfaG91cnMpID0+IHtcbiAgY29uc3QgaG91cnMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1ob3VycycpO1xuICBmb3IgKGNvbnN0IGtleSBpbiBvcGVyYXRpbmdIb3Vycykge1xuICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob3BlcmF0aW5nSG91cnMsIGtleSkpIHtcbiAgICAgIGNvbnN0IHJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RyJyk7XG5cbiAgICAgIGNvbnN0IGRheSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RkJyk7XG4gICAgICBkYXkuaW5uZXJIVE1MID0ga2V5O1xuICAgICAgcm93LmFwcGVuZENoaWxkKGRheSk7XG5cbiAgICAgIGNvbnN0IHRpbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZCcpO1xuICAgICAgdGltZS5pbm5lckhUTUwgPSBvcGVyYXRpbmdIb3Vyc1trZXldO1xuICAgICAgcm93LmFwcGVuZENoaWxkKHRpbWUpO1xuXG4gICAgICBob3Vycy5hcHBlbmRDaGlsZChyb3cpO1xuICAgIH1cbiAgfVxufTtcblxuY29uc3QgbWFya1Jlc3RhdXJhbnRBc0Zhdm91cml0ZSA9IChidXR0b24pID0+IHtcbiAgY29uc3QgaWNvbiA9IGJ1dHRvbi5xdWVyeVNlbGVjdG9yKCdpJyk7XG4gIGNvbnN0IHRleHQgPSBidXR0b24ucXVlcnlTZWxlY3Rvcignc3BhbicpO1xuICB0ZXh0LmlubmVySFRNTCA9ICdVbm1hcmsgcmVzdGF1cmFudCBhcyBmYXZvdXJpdGUnO1xuICBpY29uLmNsYXNzTGlzdC5hZGQoJ2ZhcycsICdtYXJrZWQnKTtcbiAgaWNvbi5jbGFzc0xpc3QucmVtb3ZlKCdmYXInLCAndW5tYXJrZWQnKTtcbiAgaWNvbi5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCAnUmVzdGF1cmFudCBpcyBjdXJyZW50bHkgbWFya2VkIGFzIGZhdm91cml0ZScpO1xufTtcblxuY29uc3QgdW5tYXJrUmVzdGF1cmFudEFzRmF2b3VyaXRlID0gKGJ1dHRvbikgPT4ge1xuICBjb25zdCBpY29uID0gYnV0dG9uLnF1ZXJ5U2VsZWN0b3IoJ2knKTtcbiAgY29uc3QgdGV4dCA9IGJ1dHRvbi5xdWVyeVNlbGVjdG9yKCdzcGFuJyk7XG4gIHRleHQuaW5uZXJIVE1MID0gJ01hcmsgcmVzdGF1cmFudCBhcyBmYXZvdXJpdGUnO1xuICBpY29uLmNsYXNzTGlzdC5hZGQoJ2ZhcicsICd1bm1hcmtlZCcpO1xuICBpY29uLmNsYXNzTGlzdC5yZW1vdmUoJ2ZhcycsICdtYXJrZWQnKTtcbiAgaWNvbi5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCAnUmVzdGF1cmFudCBpcyBub3QgY3VycmVudGx5IG1hcmtlZCBhcyBmYXZvdXJpdGUnKTtcbn07XG5cbi8qKlxuICogU2V0IHN0YXRlIGFuZCB0ZXh0IGZvciBtYXJrIGFzIGZhdm91cml0ZSBidXR0b24uXG4gKi9cbmNvbnN0IGZpbGxNYXJrQXNGYXZvdXJpdGVIVE1MID0gKGlzRmF2b3VyaXRlID0gc2VsZi5yZXN0YXVyYW50LmlzX2Zhdm9yaXRlKSA9PiB7XG4gIGNvbnN0IGZhdm91cml0ZUJ1dHRvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYXJrLWFzLWZhdm91cml0ZScpO1xuICBpZiAoc3RyaW5nVG9Cb29sZWFuKGlzRmF2b3VyaXRlKSkge1xuICAgIG1hcmtSZXN0YXVyYW50QXNGYXZvdXJpdGUoZmF2b3VyaXRlQnV0dG9uKTtcbiAgfSBlbHNlIHtcbiAgICB1bm1hcmtSZXN0YXVyYW50QXNGYXZvdXJpdGUoZmF2b3VyaXRlQnV0dG9uKTtcbiAgfVxufTtcblxuLyoqXG4gKiBHZXQgY3VycmVudCByZXN0YXVyYW50IGZyb20gcGFnZSBVUkwuXG4gKi9cbmNvbnN0IGZldGNoUmV2aWV3cyA9IChpZCkgPT4ge1xuICBEQkhlbHBlci5mZXRjaFJldmlld3NCeVJlc3RhdXJhbnRJZChpZCwgKGVycm9yLCByZXZpZXdzKSA9PiB7XG4gICAgc2VsZi5yZXZpZXdzID0gcmV2aWV3cztcbiAgICBpZiAoIXJldmlld3MpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBmaWxsUmV2aWV3c0hUTUwoKTtcbiAgICBEQkhlbHBlci5nZXRPdXRib3hSZXZpZXdzKGlkLCAoZXJyb3IsIG91dGJveFJldmlld3MpID0+IHtcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzZWxmLm91dGJveFJldmlld3MgPSBvdXRib3hSZXZpZXdzO1xuICAgICAgICBmaWxsU2VuZGluZ1Jldmlld3NIVE1MKCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xufTtcblxuLyoqXG4gKiBDcmVhdGUgYWxsIHJldmlld3MgSFRNTCBhbmQgYWRkIHRoZW0gdG8gdGhlIHdlYnBhZ2UuXG4gKi9cbmNvbnN0IGZpbGxSZXZpZXdzSFRNTCA9IChyZXZpZXdzID0gc2VsZi5yZXZpZXdzKSA9PiB7XG4gIGlmICghcmV2aWV3cyB8fCByZXZpZXdzLmxlbmd0aCA9PT0gMCkge1xuICAgIGNvbnN0IG5vUmV2aWV3cyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcbiAgICBub1Jldmlld3MuaW5uZXJIVE1MID0gJ05vIHJldmlld3MgeWV0ISc7XG4gICAgY29udGFpbmVyLmFwcGVuZENoaWxkKG5vUmV2aWV3cyk7XG4gICAgcmV0dXJuO1xuICB9XG4gIGNvbnN0IHVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jldmlld3MtbGlzdCcpO1xuICByZXZpZXdzLmZvckVhY2goKHJldmlldykgPT4ge1xuICAgIHVsLmluc2VydEJlZm9yZShjcmVhdGVSZXZpZXdIVE1MKHJldmlldyksIHVsLmZpcnN0Q2hpbGQpO1xuICB9KTtcbn07XG5cbmNvbnN0IGZpbGxTZW5kaW5nUmV2aWV3c0hUTUwgPSAob3V0Ym94UmV2aWV3cyA9IHNlbGYub3V0Ym94UmV2aWV3cykgPT4ge1xuICBpZiAoIW91dGJveFJldmlld3MgfHwgb3V0Ym94UmV2aWV3cy5sZW5ndGggPT09IDApIHJldHVybjtcblxuICBjb25zdCB1bCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXZpZXdzLWxpc3QnKTtcbiAgb3V0Ym94UmV2aWV3cy5mb3JFYWNoKChvdXRib3hSZXZpZXcpID0+IHtcbiAgICBjb25zdCB7IHJlcXVlc3RfaWQsIC4uLnJldmlldyB9ID0gb3V0Ym94UmV2aWV3O1xuICAgIHVsLmluc2VydEJlZm9yZShjcmVhdGVSZXZpZXdIVE1MKHJldmlldywgdHJ1ZSwgcmVxdWVzdF9pZCksIHVsLmZpcnN0Q2hpbGQpO1xuICB9KTtcbn07XG5cbi8qKlxuICogQ3JlYXRlIHJldmlldyBIVE1MIGFuZCBhZGQgaXQgdG8gdGhlIHdlYnBhZ2UuXG4gKi9cbmNvbnN0IGNyZWF0ZVJldmlld0hUTUwgPSAocmV2aWV3LCBzZW5kaW5nLCByZXF1ZXN0SWQpID0+IHtcbiAgY29uc3QgYXJ0aWNsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2FydGljbGUnKTtcbiAgYXJ0aWNsZS5jbGFzc05hbWUgPSAncmV2aWV3JztcblxuICBjb25zdCBoZWFkZXJTcGFuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuICBoZWFkZXJTcGFuLmNsYXNzTmFtZSA9ICdyZXZpZXctaGVhZGVyJztcblxuICBjb25zdCBuYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xuICBuYW1lLmlubmVySFRNTCA9IHJldmlldy5uYW1lO1xuICBuYW1lLmNsYXNzTmFtZSA9ICdyZXZpZXctbmFtZSc7XG4gIGhlYWRlclNwYW4uYXBwZW5kQ2hpbGQobmFtZSk7XG5cbiAgY29uc3QgZGF0ZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcblxuICBpZiAoc2VuZGluZykge1xuICAgIGNvbnN0IGljb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpJyk7XG4gICAgaWNvbi5jbGFzc0xpc3QuYWRkKCdmYXInLCAnZmEtY2xvY2snKTtcbiAgICBjb25zdCBsb2FkaW5nVGV4dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgICBsb2FkaW5nVGV4dC5pbm5lckhUTUwgPSAnU2VuZGluZyc7XG4gICAgZGF0ZS5hcHBlbmRDaGlsZChpY29uKTtcbiAgICBkYXRlLmFwcGVuZENoaWxkKGxvYWRpbmdUZXh0KTtcbiAgfSBlbHNlIHtcbiAgICBjb25zdCBkYXRlVGV4dCA9IGZvcm1hdERhdGUobmV3IERhdGUocmV2aWV3LnVwZGF0ZWRBdCkpO1xuICAgIGRhdGUuaW5uZXJIVE1MID0gZGF0ZVRleHQ7XG4gIH1cblxuICBkYXRlLmNsYXNzTmFtZSA9ICdyZXZpZXctZGF0ZSc7XG4gIGhlYWRlclNwYW4uYXBwZW5kQ2hpbGQoZGF0ZSk7XG4gIGFydGljbGUuYXBwZW5kQ2hpbGQoaGVhZGVyU3Bhbik7XG5cbiAgY29uc3QgY29udGVudFNwYW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gIGNvbnRlbnRTcGFuLmNsYXNzTmFtZSA9ICdyZXZpZXctY29udGVudCc7XG5cbiAgY29uc3QgcmF0aW5nID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xuICByYXRpbmcuaW5uZXJIVE1MID0gYFJhdGluZzogJHtyZXZpZXcucmF0aW5nfWA7XG4gIHJhdGluZy5jbGFzc05hbWUgPSAncmV2aWV3LXJhdGluZyc7XG4gIGNvbnRlbnRTcGFuLmFwcGVuZENoaWxkKHJhdGluZyk7XG5cbiAgY29uc3QgY29tbWVudHMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XG4gIGNvbW1lbnRzLmlubmVySFRNTCA9IHJldmlldy5jb21tZW50cztcbiAgY29udGVudFNwYW4uYXBwZW5kQ2hpbGQoY29tbWVudHMpO1xuICBhcnRpY2xlLmFwcGVuZENoaWxkKGNvbnRlbnRTcGFuKTtcblxuICBpZiAoc2VuZGluZykge1xuICAgIGFydGljbGUuc2V0QXR0cmlidXRlKCdkYXRhLWlkJywgcmVxdWVzdElkKTtcbiAgICBhcnRpY2xlLnNldEF0dHJpYnV0ZSgnYXJpYS1idXN5JywgJ3RydWUnKTtcbiAgICBhcnRpY2xlLmNsYXNzTGlzdC5hZGQoJ3NlbmRpbmcnKTtcbiAgfVxuXG4gIHJldHVybiBhcnRpY2xlO1xufTtcblxuY29uc3QgdXBkYXRlUmV2aWV3SFRNTCA9IChlcnJvciwgcmVxdWVzdElkLCByZXZpZXcpID0+IHtcbiAgY29uc3QgcmV2aWV3RWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYFtkYXRhLWlkPVwiJHtyZXF1ZXN0SWR9XCJdYCk7XG4gIGlmIChlcnJvcikge1xuICAgIGlmIChyZXZpZXdFbGVtZW50KSB7IC8vIGZvciBlcnJvciwgbm8gbmVlZCB0byBhZGQgdG8gVUkgaWYgaXQgZG9lc24ndCBleGlzdFxuICAgICAgY29uc3QgZGF0ZSA9IHJldmlld0VsZW1lbnQucXVlcnlTZWxlY3RvcignLnJldmlldy1kYXRlJyk7XG4gICAgICBkYXRlLmlubmVySFRNTCA9ICcnO1xuICAgICAgY29uc3QgaWNvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2knKTtcbiAgICAgIGljb24uY2xhc3NMaXN0LmFkZCgnZmFzJywgJ2ZhLWV4Y2xhbWF0aW9uLXRyaWFuZ2xlJyk7XG4gICAgICBjb25zdCBlcnJvclRleHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gICAgICBlcnJvclRleHQuaW5uZXJIVE1MID0gJ1NlbmRpbmcgZmFpbGVkJztcbiAgICAgIGRhdGUuYXBwZW5kQ2hpbGQoaWNvbik7XG4gICAgICBkYXRlLmFwcGVuZENoaWxkKGVycm9yVGV4dCk7XG4gICAgICBkYXRlLmNsYXNzTGlzdC5hZGQoJ2Vycm9yJyk7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIGNvbnN0IHVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jldmlld3MtbGlzdCcpO1xuICAgIGlmICh1bCAmJiBzZWxmLnJlc3RhdXJhbnQpIHsgLy8gb25seSB1cGRhdGUgaWYgdGhlIHJlc3RhdXJhbnQgaXMgbG9hZGVkXG4gICAgICBpZiAocmV2aWV3RWxlbWVudCkge1xuICAgICAgICByZXZpZXdFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ3NlbmRpbmcnKTtcbiAgICAgICAgY29uc3QgZGF0ZSA9IHJldmlld0VsZW1lbnQucXVlcnlTZWxlY3RvcignLnJldmlldy1kYXRlJyk7XG4gICAgICAgIGNvbnN0IGRhdGVUZXh0ID0gZm9ybWF0RGF0ZShuZXcgRGF0ZShyZXZpZXcudXBkYXRlZEF0KSk7XG4gICAgICAgIGRhdGUuaW5uZXJIVE1MID0gZGF0ZVRleHQ7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjcmVhdGVSZXZpZXdIVE1MKHJldmlldywgZmFsc2UpO1xuICAgICAgfVxuICAgIH1cbiAgfVxufTtcblxuLyoqXG4gKiBBZGQgcmVzdGF1cmFudCBuYW1lIHRvIHRoZSBicmVhZGNydW1iIG5hdmlnYXRpb24gbWVudVxuICovXG5jb25zdCBmaWxsQnJlYWRjcnVtYiA9IChyZXN0YXVyYW50ID0gc2VsZi5yZXN0YXVyYW50KSA9PiB7XG4gIGNvbnN0IGJyZWFkY3J1bWIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnJlYWRjcnVtYicpO1xuICBjb25zdCBsaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XG4gIGxpLmlubmVySFRNTCA9IHJlc3RhdXJhbnQubmFtZTtcbiAgYnJlYWRjcnVtYi5hcHBlbmRDaGlsZChsaSk7XG59O1xuXG4vKipcbiAqIEdldCBhIHBhcmFtZXRlciBieSBuYW1lIGZyb20gcGFnZSBVUkwuXG4gKi9cbmNvbnN0IGdldFVybFBhcmFtID0gKG5hbWUsIHVybCkgPT4ge1xuICB1cmwgPSB1cmwgfHwgd2luZG93LmxvY2F0aW9uLmhyZWY7XG4gIG5hbWUgPSBuYW1lLnJlcGxhY2UoL1tcXFtcXF1dL2csICdcXFxcJCYnKTtcbiAgY29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKGBbPyZdJHtuYW1lfSg9KFteJiNdKil8JnwjfCQpYCk7XG5cblxuICBjb25zdCByZXN1bHRzID0gcmVnZXguZXhlYyh1cmwpO1xuICBpZiAoIXJlc3VsdHMpIHJldHVybiBudWxsO1xuICBpZiAoIXJlc3VsdHNbMl0pIHJldHVybiAnJztcbiAgcmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudChyZXN1bHRzWzJdLnJlcGxhY2UoL1xcKy9nLCAnICcpKTtcbn07XG5cbmNvbnN0IHNldE1hcmtBc0Zhdm91cml0ZUZldGNoaW5nU3RhdGUgPSAoYnV0dG9uLCBzcGlubmVyKSA9PiB7XG4gIGJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgdHJ1ZSk7XG4gIGJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2FyaWEtYnVzeScsICd0cnVlJyk7XG4gIHNwaW5uZXIuY2xhc3NMaXN0LmFkZCgnc2hvdycpO1xufTtcblxuY29uc3QgcmVtb3ZlTWFya0FzRmF2b3VyaXRlRmV0Y2hpbmdTdGF0ZSA9IChidXR0b24sIHNwaW5uZXIpID0+IHtcbiAgYnV0dG9uLnJlbW92ZUF0dHJpYnV0ZSgnZGlzYWJsZWQnKTtcbiAgYnV0dG9uLnNldEF0dHJpYnV0ZSgnYXJpYS1idXN5JywgJ2ZhbHNlJyk7XG4gIHNwaW5uZXIuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpO1xufTtcblxuY29uc3QgdG9nZ2xlUmVzdGF1cmFudEFzRmF2b3VyaXRlID0gKCkgPT4ge1xuICBjb25zdCBpc0Zhdm91cml0ZSA9IHN0cmluZ1RvQm9vbGVhbihzZWxmLnJlc3RhdXJhbnQuaXNfZmF2b3JpdGUpO1xuICBjb25zdCBuZXdJc0Zhdm91cml0ZSA9ICghaXNGYXZvdXJpdGUpICYmIGlzRmF2b3VyaXRlICE9PSAnZmFsc2UnO1xuICBjb25zdCByZXN0YXVyYW50SWQgPSBzZWxmLnJlc3RhdXJhbnQuaWQ7XG4gIGNvbnN0IGJ1dHRvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYXJrLWFzLWZhdm91cml0ZScpO1xuICBjb25zdCBzcGlubmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Zhdm91cml0ZS1zcGlubmVyJyk7XG4gIGxldCBmYWlsZWRVcGRhdGVDYWxsYmFjaztcbiAgbGV0IHN1Y2Nlc3NNZXNzYWdlO1xuICBsZXQgZXJyb3JNZXNzYWdlO1xuICBpZiAobmV3SXNGYXZvdXJpdGUpIHtcbiAgICBtYXJrUmVzdGF1cmFudEFzRmF2b3VyaXRlKGJ1dHRvbik7XG4gICAgZmFpbGVkVXBkYXRlQ2FsbGJhY2sgPSB1bm1hcmtSZXN0YXVyYW50QXNGYXZvdXJpdGU7XG4gICAgc3VjY2Vzc01lc3NhZ2UgPSAnUmVzdGF1cmFudCBoYXMgYmVlbiBtYXJrZWQgYXMgZmF2b3VyaXRlJztcbiAgICBlcnJvck1lc3NhZ2UgPSAnQW4gZXJyb3Igb2NjdXJyZWQgbWFya2luZyByZXN0YXVyYW50IGFzIGZhdm91cml0ZSc7XG4gIH0gZWxzZSB7XG4gICAgdW5tYXJrUmVzdGF1cmFudEFzRmF2b3VyaXRlKGJ1dHRvbik7XG4gICAgZmFpbGVkVXBkYXRlQ2FsbGJhY2sgPSBtYXJrUmVzdGF1cmFudEFzRmF2b3VyaXRlO1xuICAgIHN1Y2Nlc3NNZXNzYWdlID0gJ1Jlc3RhdXJhbnQgaGFzIGJlZW4gdW5tYXJrZWQgYXMgZmF2b3VyaXRlJztcbiAgICBlcnJvck1lc3NhZ2UgPSAnQW4gZXJyb3Igb2NjdXJyZWQgdW5tYXJraW5nIHJlc3RhdXJhbnQgYXMgZmF2b3VyaXRlJztcbiAgfVxuICBzZXRNYXJrQXNGYXZvdXJpdGVGZXRjaGluZ1N0YXRlKGJ1dHRvbiwgc3Bpbm5lcik7XG4gIERCSGVscGVyLnNldFJlc3RhdXJhbnRGYXZvdXJpdGVTdGF0dXMocmVzdGF1cmFudElkLCBuZXdJc0Zhdm91cml0ZSwgKGVycm9yLCB1cGRhdGVkUmVzdGF1cmFudCkgPT4ge1xuICAgIHJlbW92ZU1hcmtBc0Zhdm91cml0ZUZldGNoaW5nU3RhdGUoYnV0dG9uLCBzcGlubmVyKTtcbiAgICBpZiAoIXVwZGF0ZWRSZXN0YXVyYW50KSB7XG4gICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcbiAgICAgIGZhaWxlZFVwZGF0ZUNhbGxiYWNrKGJ1dHRvbik7XG4gICAgICBlbnF1ZXVlVG9hc3QoZXJyb3JNZXNzYWdlLCAnZXJyb3InKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgc2VsZi5yZXN0YXVyYW50ID0gdXBkYXRlZFJlc3RhdXJhbnQ7XG4gICAgZW5xdWV1ZVRvYXN0KHN1Y2Nlc3NNZXNzYWdlLCAnc3VjY2VzcycpO1xuICB9KTtcbn07XG5cbmZ1bmN0aW9uIHNob3dDb25uZWN0aW9uU3RhdHVzKCkge1xuICBjb25zdCBjb25uZWN0aW9uU3RhdHVzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Nvbm5lY3Rpb25TdGF0dXMnKTtcblxuICBpZiAobmF2aWdhdG9yLm9uTGluZSAmJiAhcHJldmlvdXNseUNvbm5lY3RlZCkgeyAvLyB1c2VyIGNhbWUgYmFjayBvbmxpbmVcbiAgICBlbnF1ZXVlVG9hc3QoJ1lvdSBhcmUgYmFjayBvbmxpbmUnLCAnc3VjY2VzcycpO1xuICB9IGVsc2UgaWYgKCFuYXZpZ2F0b3Iub25MaW5lICYmIHByZXZpb3VzbHlDb25uZWN0ZWQpIHsgLy8gdXNlciB3ZW50IG9mZmxpbmVcbiAgICBlbnF1ZXVlVG9hc3QoJ1lvdSBhcmUgb2ZmbGluZScsICdlcnJvcicpO1xuICB9XG5cbiAgcHJldmlvdXNseUNvbm5lY3RlZCA9IG5hdmlnYXRvci5vbkxpbmU7XG59XG4iLCIvKiogKioqKiBtb2RhbCAqKioqKiogKi9cblxubGV0IHByZXZpb3VzbHlGb2N1c2VkRWxlbWVudDtcblxuZnVuY3Rpb24gb3Blbk1vZGFsKCkge1xuICBwcmV2aW91c2x5Rm9jdXNlZEVsZW1lbnQgPSBkb2N1bWVudC5hY3RpdmVFbGVtZW50O1xuICBjb25zdCBvdmVybGF5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm92ZXJsYXknKTtcbiAgY29uc3QgaW50ZXJhY3RpdmVFbGVtZW50cyA9IG92ZXJsYXkucXVlcnlTZWxlY3RvckFsbCgnYnV0dG9uLCBpbnB1dCwgdGV4dGFyZWEnKTtcbiAgb3ZlcmxheS5jbGFzc0xpc3QuYWRkKCdzaG93Jyk7XG4gIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LmFkZCgnaGFzLW9wZW4tbW9kYWwnKTtcbiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRyYXBUYWJLZXkpO1xuICAvLyBmb2N1cyB0aGUgZmlyc3QgZWxlbWVudCBpbiB0aGUgb3ZlcmxheS4gdGltZW91dCBpcyBuZWVkZWQgYmVjYXVzZSBvZiBDU1MgdHJhbnNpdGlvblxuICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICBpbnRlcmFjdGl2ZUVsZW1lbnRzWzBdLmZvY3VzKCk7XG4gIH0sIDEwMCk7XG59XG5cbmZ1bmN0aW9uIGNsb3NlTW9kYWwoKSB7XG4gIGNsZWFyRm9ybUVycm9ycygpO1xuICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcub3ZlcmxheScpLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKTtcbiAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QucmVtb3ZlKCdoYXMtb3Blbi1tb2RhbCcpO1xuICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdHJhcFRhYktleSk7XG4gIGlmIChwcmV2aW91c2x5Rm9jdXNlZEVsZW1lbnQpIHtcbiAgICBwcmV2aW91c2x5Rm9jdXNlZEVsZW1lbnQuZm9jdXMoKTtcbiAgfVxufVxuXG5mdW5jdGlvbiB0cmFwVGFiS2V5KGV2ZW50KSB7XG4gIGNvbnN0IG92ZXJsYXkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcub3ZlcmxheScpO1xuICBjb25zdCBpbnRlcmFjdGl2ZUVsZW1lbnRzID0gb3ZlcmxheS5xdWVyeVNlbGVjdG9yQWxsKCdidXR0b24sIGlucHV0Jyk7XG4gIGNvbnN0IGZpcnN0RWxlbWVudCA9IGludGVyYWN0aXZlRWxlbWVudHNbMF07XG4gIGNvbnN0IGxhc3RFbGVtZW50ID0gaW50ZXJhY3RpdmVFbGVtZW50c1tpbnRlcmFjdGl2ZUVsZW1lbnRzLmxlbmd0aCAtIDFdO1xuICBpZiAoZXZlbnQua2V5ICYmIGV2ZW50LmtleSA9PT0gJ1RhYicpIHtcbiAgICBpZiAoZXZlbnQuc2hpZnRLZXkgJiYgZXZlbnQudGFyZ2V0ID09PSBmaXJzdEVsZW1lbnQpIHsgLy8gc2hpZnQgKyB0YWJcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICBsYXN0RWxlbWVudC5mb2N1cygpO1xuICAgIH0gZWxzZSBpZiAoIWV2ZW50LnNoaWZ0S2V5ICYmIGV2ZW50LnRhcmdldCA9PT0gbGFzdEVsZW1lbnQpIHsgLy8gdGFiXG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgZmlyc3RFbGVtZW50LmZvY3VzKCk7XG4gICAgfVxuICB9XG59XG5cbi8qKiAqKioqIGhhbmRsZSBlcnJvcnMgKioqKioqICovXG5cbmZ1bmN0aW9uIHNldE5hbWVJbnB1dEVycm9yKCkge1xuICBjb25zdCBuYW1lSW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpO1xuICBjb25zdCBuYW1lSW5wdXRFcnJvciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lLWVycm9yJyk7XG4gIG5hbWVJbnB1dC5jbGFzc0xpc3QuYWRkKCdoYXMtZXJyb3InKTtcbiAgbmFtZUlucHV0LnNldEF0dHJpYnV0ZSgnYXJpYS1pbnZhbGlkJywgJ3RydWUnKTtcbiAgbmFtZUlucHV0LnNldEF0dHJpYnV0ZSgnYXJpYS1kZXNjcmliZWRieScsICduYW1lLWVycm9yJyk7XG4gIG5hbWVJbnB1dEVycm9yLmNsYXNzTGlzdC5hZGQoJ3Nob3cnKTtcbn1cblxuZnVuY3Rpb24gY2xlYXJOYW1lSW5wdXRFcnJvcigpIHtcbiAgY29uc3QgbmFtZUlucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25hbWUnKTtcbiAgY29uc3QgbmFtZUlucHV0RXJyb3IgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZS1lcnJvcicpO1xuICBuYW1lSW5wdXQuY2xhc3NMaXN0LnJlbW92ZSgnaGFzLWVycm9yJyk7XG4gIG5hbWVJbnB1dC5yZW1vdmVBdHRyaWJ1dGUoJ2FyaWEtaW52YWxpZCcpO1xuICBuYW1lSW5wdXQucmVtb3ZlQXR0cmlidXRlKCdhcmlhLWRlc2NyaWJlZGJ5Jyk7XG4gIG5hbWVJbnB1dEVycm9yLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKTtcbn1cblxuZnVuY3Rpb24gc2V0UmF0aW5nSW5wdXRFcnJvcigpIHtcbiAgY29uc3QgcmF0aW5nSW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmF0aW5nJyk7XG4gIGNvbnN0IHJhdGluZ0lucHV0RXJyb3IgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmF0aW5nLWVycm9yJyk7XG4gIHJhdGluZ0lucHV0LmNsYXNzTGlzdC5hZGQoJ2hhcy1lcnJvcicpO1xuICByYXRpbmdJbnB1dC5zZXRBdHRyaWJ1dGUoJ2FyaWEtaW52YWxpZCcsICd0cnVlJyk7XG4gIHJhdGluZ0lucHV0LnNldEF0dHJpYnV0ZSgnYXJpYS1kZXNjcmliZWRieScsICdyYXRpbmctZXJyb3InKTtcbiAgcmF0aW5nSW5wdXRFcnJvci5jbGFzc0xpc3QuYWRkKCdzaG93Jyk7XG59XG5cbmZ1bmN0aW9uIGNsZWFyUmF0aW5nSW5wdXRFcnJvcigpIHtcbiAgY29uc3QgcmF0aW5nSW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmF0aW5nJyk7XG4gIGNvbnN0IHJhdGluZ0lucHV0RXJyb3IgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmF0aW5nLWVycm9yJyk7XG4gIHJhdGluZ0lucHV0LmNsYXNzTGlzdC5yZW1vdmUoJ2hhcy1lcnJvcicpO1xuICByYXRpbmdJbnB1dC5yZW1vdmVBdHRyaWJ1dGUoJ2FyaWEtaW52YWxpZCcpO1xuICByYXRpbmdJbnB1dC5yZW1vdmVBdHRyaWJ1dGUoJ2FyaWEtZGVzY3JpYmVkYnknKTtcbiAgcmF0aW5nSW5wdXRFcnJvci5jbGFzc0xpc3QucmVtb3ZlKCdzaG93Jyk7XG59XG5cbmZ1bmN0aW9uIHNldENvbW1lbnRJbnB1dEVycm9yKCkge1xuICBjb25zdCBjb21tZW50SW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29tbWVudHMnKTtcbiAgY29uc3QgY29tbWVudElucHV0RXJyb3IgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29tbWVudHMtZXJyb3InKTtcbiAgY29tbWVudElucHV0LmNsYXNzTGlzdC5hZGQoJ2hhcy1lcnJvcicpO1xuICBjb21tZW50SW5wdXQuc2V0QXR0cmlidXRlKCdhcmlhLWludmFsaWQnLCAndHJ1ZScpO1xuICBjb21tZW50SW5wdXQuc2V0QXR0cmlidXRlKCdhcmlhLWRlc2NyaWJlZGJ5JywgJ2NvbW1lbnRzLWVycm9yJyk7XG4gIGNvbW1lbnRJbnB1dEVycm9yLmNsYXNzTGlzdC5hZGQoJ3Nob3cnKTtcbn1cblxuZnVuY3Rpb24gY2xlYXJDb21tZW50SW5wdXRFcnJvcigpIHtcbiAgY29uc3QgY29tbWVudElucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvbW1lbnRzJyk7XG4gIGNvbnN0IGNvbW1lbnRJbnB1dEVycm9yID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvbW1lbnRzLWVycm9yJyk7XG4gIGNvbW1lbnRJbnB1dC5jbGFzc0xpc3QucmVtb3ZlKCdoYXMtZXJyb3InKTtcbiAgY29tbWVudElucHV0LnJlbW92ZUF0dHJpYnV0ZSgnYXJpYS1pbnZhbGlkJyk7XG4gIGNvbW1lbnRJbnB1dC5yZW1vdmVBdHRyaWJ1dGUoJ2FyaWEtZGVzY3JpYmVkYnknKTtcbiAgY29tbWVudElucHV0RXJyb3IuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpO1xufVxuXG5jb25zdCBlcnJvckZ1bmN0aW9ucyA9IHtcbiAgbmFtZToge1xuICAgIHNldEVycm9yOiBzZXROYW1lSW5wdXRFcnJvcixcbiAgICBjbGVhckVycm9yOiBjbGVhck5hbWVJbnB1dEVycm9yLFxuICB9LFxuICByYXRpbmc6IHtcbiAgICBzZXRFcnJvcjogc2V0UmF0aW5nSW5wdXRFcnJvcixcbiAgICBjbGVhckVycm9yOiBjbGVhclJhdGluZ0lucHV0RXJyb3IsXG4gIH0sXG4gIGNvbW1lbnRzOiB7XG4gICAgc2V0RXJyb3I6IHNldENvbW1lbnRJbnB1dEVycm9yLFxuICAgIGNsZWFyRXJyb3I6IGNsZWFyQ29tbWVudElucHV0RXJyb3IsXG4gIH0sXG59O1xuXG4vKiogKioqKiB2YWxpZGF0aW9uICoqKioqKiAqL1xuXG5mdW5jdGlvbiB2YWxpZGF0ZUlucHV0KGlkLCB2YWx1ZSkge1xuICBjb25zdCBpbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKS5jbG9uZU5vZGUoKTtcbiAgbGV0IGlucHV0VmFsdWU7XG4gIGlmICh2YWx1ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgaW5wdXRWYWx1ZSA9IHZhbHVlO1xuICB9IGVsc2Uge1xuICAgIGlucHV0VmFsdWUgPSBpbnB1dC52YWx1ZTtcbiAgfVxuICBpbnB1dFZhbHVlID0gaWQgPT09ICdyYXRpbmcnID8gTnVtYmVyLnBhcnNlSW50KGlucHV0VmFsdWUsIDEwKSA6IGlucHV0VmFsdWU7XG4gIGlmIChpbnB1dFZhbHVlKSB7XG4gICAgZXJyb3JGdW5jdGlvbnNbaWRdLmNsZWFyRXJyb3IoKTtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZXJyb3JGdW5jdGlvbnNbaWRdLnNldEVycm9yKTtcbiAgcmV0dXJuIGZhbHNlO1xufVxuXG5mdW5jdGlvbiB2YWxpZGF0ZUFsbElucHV0cygpIHtcbiAgbGV0IGVycm9yID0gZmFsc2U7XG4gIGNvbnN0IGlucHV0SWRzID0gWyduYW1lJywgJ3JhdGluZycsICdjb21tZW50cyddO1xuICBjb25zdCBpbnZhbGlkSW5wdXRzID0gW107XG4gIGlucHV0SWRzLmZvckVhY2goKGlkKSA9PiB7XG4gICAgY29uc3QgaW5wdXRWYWxpZCA9IHZhbGlkYXRlSW5wdXQoaWQpO1xuICAgIGlmICghaW5wdXRWYWxpZCkge1xuICAgICAgaW52YWxpZElucHV0cy5wdXNoKGlkKTtcbiAgICAgIGVycm9yID0gdHJ1ZTtcbiAgICB9XG4gIH0pO1xuICByZXR1cm4geyBlcnJvciwgaW52YWxpZElucHV0cyB9O1xufVxuXG4vKiogKioqKiBoYW5kbGUgZXZlbnRzICoqKioqKiAqL1xuXG5mdW5jdGlvbiBoYW5kbGVSYW5nZUNoYW5nZShldmVudCkge1xuICBjb25zdCByYXRpbmdWYWx1ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5yYXRpbmctdmFsdWUnKTtcbiAgcmF0aW5nVmFsdWUuaW5uZXJIVE1MID0gYCR7ZXZlbnQudGFyZ2V0LnZhbHVlfS81YDtcbiAgdmFsaWRhdGVJbnB1dChldmVudC50YXJnZXQubmFtZSwgZXZlbnQudGFyZ2V0LnZhbHVlKTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlSW5wdXRLZXlVcChldmVudCkge1xuICBpZiAoIShldmVudC5rZXkgJiYgZXZlbnQua2V5ID09PSAnVGFiJykpIHtcbiAgICAvLyB3aGVuIHRhYiBpcyB1c2VkLCBhbGxvdyB0aGUgb25ibHVyIGhhbmRsZXIgdG8gcGVyZm9ybSB2YWxpZGF0aW9uXG4gICAgLy8gd2hlbiB0aGUgdGFiIGtleSBpcyBwcmVzc2VkLCBmb2N1cyBpcyBhbHJlYWR5IG9uIHRoZSBuZXh0IGlucHV0IHdoZW4gdGhlIGV2ZW50IGZpcmVzXG4gICAgLy8gc28gdGhlIHdyb25nIGlucHV0IGlzIHZhbGlkYXRlZFxuICAgIHZhbGlkYXRlSW5wdXQoZXZlbnQudGFyZ2V0Lm5hbWUsIGV2ZW50LnRhcmdldC52YWx1ZSk7XG4gIH1cbn1cblxuZnVuY3Rpb24gaGFuZGxlSW5wdXRCbHVyKGV2ZW50KSB7XG4gIHZhbGlkYXRlSW5wdXQoZXZlbnQudGFyZ2V0Lm5hbWUsIGV2ZW50LnRhcmdldC52YWx1ZSk7XG59XG5cbmZ1bmN0aW9uIGdldEZvcm1JbnB1dFZhbHVlcygpIHtcbiAgY29uc3QgaW5wdXRJZHMgPSBbJ25hbWUnLCAncmF0aW5nJywgJ2NvbW1lbnRzJ107XG4gIGNvbnN0IHZhbHVlcyA9IHt9O1xuICBpbnB1dElkcy5mb3JFYWNoKChpZCkgPT4ge1xuICAgIHZhbHVlc1tpZF0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCkudmFsdWU7XG4gIH0pO1xuICByZXR1cm4gdmFsdWVzO1xufVxuXG5mdW5jdGlvbiBjbGVhckZvcm0oKSB7XG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykudmFsdWUgPSAnJztcbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3JhdGluZycpLnZhbHVlID0gJzAnO1xuICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucmF0aW5nLXZhbHVlJykuaW5uZXJIVE1MID0gJzAvNSc7XG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjb21tZW50cycpLnZhbHVlID0gJyc7XG59XG5cbmZ1bmN0aW9uIGNsZWFyRm9ybUVycm9ycygpIHtcbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25hbWUtZXJyb3InKS5jbGFzc0xpc3QucmVtb3ZlKCdzaG93Jyk7XG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyYXRpbmctZXJyb3InKS5jbGFzc0xpc3QucmVtb3ZlKCdzaG93Jyk7XG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjb21tZW50cy1lcnJvcicpLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKTtcbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FkZC1yZXZpZXctZm9ybS1lcnJvcicpLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKTtcbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FkZC1yZXZpZXctZm9ybS1lcnJvcicpLmlubmVySFRNTCA9ICcnO1xuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLmNsYXNzTGlzdC5yZW1vdmUoJ2hhcy1lcnJvcicpO1xuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmF0aW5nJykuY2xhc3NMaXN0LnJlbW92ZSgnaGFzLWVycm9yJyk7XG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjb21tZW50cycpLmNsYXNzTGlzdC5yZW1vdmUoJ2hhcy1lcnJvcicpO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVBZGRSZXZpZXdTdWJtaXQoKSB7XG4gIGNvbnN0IHsgZXJyb3IsIGludmFsaWRJbnB1dHMgfSA9IHZhbGlkYXRlQWxsSW5wdXRzKCk7XG4gIGlmICghZXJyb3IpIHtcbiAgICBjb25zdCB7IG5hbWUsIHJhdGluZywgY29tbWVudHMgfSA9IGdldEZvcm1JbnB1dFZhbHVlcygpO1xuICAgIGlmICgoIW5hdmlnYXRvci5zZXJ2aWNlV29ya2VyKSB8fCAoIW5hdmlnYXRvci5zZXJ2aWNlV29ya2VyLmNvbnRyb2xsZXIpKSB7XG4gICAgICAvLyBwZXJmb3JtIHJlZ3VsYXIgZmV0Y2ggYW5kIHJlZ3VsYXIgdXBkYXRlc1xuICAgICAgY29uc3Qgc3VibWl0QnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FkZC1yZXZpZXctc3VibWl0Jyk7XG4gICAgICBzdWJtaXRCdXR0b24uc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsIHRydWUpO1xuICAgICAgc3VibWl0QnV0dG9uLnNldEF0dHJpYnV0ZSgnYXJpYS1idXN5JywgJ3RydWUnKTtcbiAgICAgIERCSGVscGVyLmFkZFJldmlldyhzZWxmLnJlc3RhdXJhbnQuaWQsIG5hbWUsIHJhdGluZywgY29tbWVudHMsIChlcnJvciwgbmV3UmV2aWV3KSA9PiB7XG4gICAgICAgIHN1Ym1pdEJ1dHRvbi5yZW1vdmVBdHRyaWJ1dGUoJ2Rpc2FibGVkJyk7XG4gICAgICAgIHN1Ym1pdEJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2FyaWEtYnVzeScsICdmYWxzZScpO1xuICAgICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgICBlbnF1ZXVlVG9hc3QoJ0FuIGVycm9yIG9jY3VycmVkLiBQbGVhc2UgdHJ5IGFnYWluJywgJ2Vycm9yJyk7XG4gICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGVucXVldWVUb2FzdChgJHtuYW1lfSdzIHJldmlldyBoYXMgYmVlbiBzYXZlZGAsICdzdWNjZXNzJyk7XG4gICAgICAgICAgY29uc3QgdWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmV2aWV3cy1saXN0Jyk7XG4gICAgICAgICAgdWwuaW5zZXJ0QmVmb3JlKGNyZWF0ZVJldmlld0hUTUwobmV3UmV2aWV3KSwgdWwuZmlyc3RDaGlsZCk7XG4gICAgICAgICAgY2xvc2VNb2RhbCgpO1xuICAgICAgICAgIGNsZWFyRm9ybSgpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgcmVxdWVzdElkID0gYCR7c2VsZi5yZXN0YXVyYW50LmlkfS0ke0RhdGUubm93KCl9YDtcbiAgICAgIGNvbnN0IG5ld1JldmlldyA9IHtcbiAgICAgICAgbmFtZSwgcmF0aW5nLCBjb21tZW50cywgcmVzdGF1cmFudF9pZDogc2VsZi5yZXN0YXVyYW50LmlkLFxuICAgICAgfTtcbiAgICAgIGNvbnN0IHVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jldmlld3MtbGlzdCcpO1xuICAgICAgdWwuaW5zZXJ0QmVmb3JlKGNyZWF0ZVJldmlld0hUTUwobmV3UmV2aWV3LCB0cnVlLCByZXF1ZXN0SWQpLCB1bC5maXJzdENoaWxkKTtcblxuICAgICAgaWYgKCgnb25MaW5lJyBpbiBuYXZpZ2F0b3IpICYmICFuYXZpZ2F0b3Iub25MaW5lKSB7XG4gICAgICAgIGVucXVldWVUb2FzdCgnWW91ciByZXZpZXcgd2lsbCBiZSBzdWJtaXR0ZWQgd2hlbiB5b3UgYXJlIGJhY2sgb25saW5lJyk7XG4gICAgICB9XG5cbiAgICAgIGNsb3NlTW9kYWwoKTtcbiAgICAgIGNsZWFyRm9ybSgpO1xuICAgICAgbmF2aWdhdG9yLnNlcnZpY2VXb3JrZXIuY29udHJvbGxlci5wb3N0TWVzc2FnZSh7XG4gICAgICAgIHR5cGU6ICdwb3N0LXJldmlldycsXG4gICAgICAgIHJldmlldzogbmV3UmV2aWV3LFxuICAgICAgICByZXF1ZXN0SWQsXG4gICAgICB9KTtcbiAgICB9XG4gIH0gZWxzZSB7IC8vIGZvcm0gZXJyb3JzIG5vdCBjbGVhcmVkXG4gICAgY29uc3QgZm9ybUVycm9yID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FkZC1yZXZpZXctZm9ybS1lcnJvcicpO1xuICAgIGNvbnN0IGVycm9yVGV4dCA9IGBJbnZhbGlkIGlucHV0IGZvcjogJHtpbnZhbGlkSW5wdXRzLmpvaW4oJywgJyl9YDtcbiAgICBmb3JtRXJyb3IuaW5uZXJIVE1MID0gZXJyb3JUZXh0O1xuICAgIGZvcm1FcnJvci5jbGFzc0xpc3QuYWRkKCdzaG93Jyk7XG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaW52YWxpZElucHV0c1swXSkuZm9jdXMoKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBoYW5kbGVGb3JtU3VibWl0KGV2ZW50KSB7XG4gIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG59XG4iXX0=
