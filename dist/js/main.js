"use strict";var restaurants,neighborhoods,cuisines,newMap,markers=[];document.addEventListener("DOMContentLoaded",function(e){initMap(),fetchNeighborhoods(),fetchCuisines(),registerServiceWorker(),window.caches&&setInterval(cleanMapboxTilesCache,5e3)});var fetchNeighborhoods=function(){DBHelper.fetchNeighborhoods(function(e,t){e?console.error(e):(self.neighborhoods=t,fillNeighborhoodsHTML())})},fillNeighborhoodsHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.neighborhoods,n=document.getElementById("neighborhoods-select");e.forEach(function(e){var t=document.createElement("option");t.innerHTML=e,t.value=e,n.append(t)})},fetchCuisines=function(){DBHelper.fetchCuisines(function(e,t){e?console.error(e):(self.cuisines=t,fillCuisinesHTML())})},fillCuisinesHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.cuisines,n=document.getElementById("cuisines-select");e.forEach(function(e){var t=document.createElement("option");t.innerHTML=e,t.value=e,n.append(t)})},initMap=function(){self.newMap=L.map("map",{center:[40.722216,-73.987501],zoom:12,scrollWheelZoom:!1}),L.tileLayer("https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.jpg70?access_token={mapboxToken}",{mapboxToken:"pk.eyJ1IjoiYW5lZXNhLXNhbGVoIiwiYSI6ImNqa2xmZHVwMDFoYW4zdnAwYWplMm53bHEifQ.V11dDOtEnWSwTxY-C8mJLw",maxZoom:18,attribution:'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',id:"mapbox.streets"}).addTo(newMap),updateRestaurants()},updateRestaurants=function(){var e=document.getElementById("cuisines-select"),t=document.getElementById("neighborhoods-select"),n=e.selectedIndex,a=t.selectedIndex,r=e[n].value,o=t[a].value;DBHelper.fetchRestaurantByCuisineAndNeighborhood(r,o,function(e,t){e?console.error(e):(resetRestaurants(t),fillRestaurantsHTML())})},resetRestaurants=function(e){self.restaurants=[],document.getElementById("restaurants-list").innerHTML="",self.markers&&self.markers.forEach(function(e){return e.remove()}),self.markers=[],self.restaurants=e},fillRestaurantsHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurants,t=document.getElementById("restaurants-list");e.forEach(function(e){t.append(createRestaurantHTML(e))}),addMarkersToMap()},createRestaurantHTML=function(e){var t=document.createElement("article"),n=document.createElement("picture"),a=document.createElement("source");a.media="(min-width: 451px) and (max-width: 749px), (min-width: 950px)",a.srcset=DBHelper.imageUrlForRestaurant(e,{size:"medium"}),a.type="image/jpeg",n.appendChild(a);var r=document.createElement("source");r.media="(max-width: 450px), (min-width: 750px) and (max-width: 949px)",r.srcset=DBHelper.imageUrlForRestaurant(e,{size:"small"}),r.type="image/jpeg",n.appendChild(r);var o=document.createElement("img");o.className="restaurant-img",o.srcset=DBHelper.imageUrlForRestaurant(e,{size:"medium"}),o.src=DBHelper.imageUrlForRestaurant(e,{size:"medium",singleValue:!0}),o.alt=e.alt,n.appendChild(o),t.append(n);var s=document.createElement("span"),i=document.createElement("h2");i.innerHTML=e.name,s.append(i);var c=document.createElement("p");c.innerHTML=e.neighborhood,s.append(c);var l=document.createElement("p");l.innerHTML=e.address,s.append(l);var d=document.createElement("a");return d.innerHTML="View Details",d.setAttribute("aria-label","View Details of ".concat(e.name)),d.href=DBHelper.urlForRestaurant(e),s.append(d),t.append(s),t},addMarkersToMap=function(){(0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurants).forEach(function(e){var t=DBHelper.mapMarkerForRestaurant(e,self.newMap);t.on("click",function(){window.location.href=t.options.url}),self.markers.push(t)})};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsicmVzdGF1cmFudHMiLCJuZWlnaGJvcmhvb2RzIiwiY3Vpc2luZXMiLCJkb2N1bWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJldmVudCIsImluaXRNYXAiLCJmZXRjaE5laWdoYm9yaG9vZHMiLCJyZWdpc3RlclNlcnZpY2VXb3JrZXIiLCJzZXRJbnRlcnZhbCIsImNsZWFuTWFwYm94VGlsZXNDYWNoZSIsIkRCSGVscGVyIiwiZXJyb3IiLCJzZWxmIiwiY29uc29sZSIsImZpbGxOZWlnaGJvcmhvb2RzSFRNTCIsImFyZ3VtZW50cyIsImxlbmd0aCIsInVuZGVmaW5lZCIsInNlbGVjdCIsImdldEVsZW1lbnRCeUlkIiwiZm9yRWFjaCIsIm5laWdoYm9yaG9vZCIsIm9wdGlvbiIsImNyZWF0ZUVsZW1lbnQiLCJmZXRjaEN1aXNpbmVzIiwiZmlsbEN1aXNpbmVzSFRNTCIsImN1aXNpbmUiLCJpbm5lckhUTUwiLCJ2YWx1ZSIsImFwcGVuZCIsImNlbnRlciIsInpvb20iLCJzY3JvbGxXaGVlbFpvb20iLCJMIiwidGlsZUxheWVyIiwibWFwYm94VG9rZW4iLCJtYXhab29tIiwibmV3TWFwIiwidXBkYXRlUmVzdGF1cmFudHMiLCJhZGRUbyIsIm5TZWxlY3QiLCJjSW5kZXgiLCJjU2VsZWN0Iiwic2VsZWN0ZWRJbmRleCIsIm5JbmRleCIsInJlc2V0UmVzdGF1cmFudHMiLCJtYXJrZXJzIiwibWFya2VyIiwicmVtb3ZlIiwidWwiLCJmaWxsUmVzdGF1cmFudHNIVE1MIiwicmVzdGF1cmFudCIsImFkZE1hcmtlcnNUb01hcCIsImFydGljbGUiLCJjcmVhdGVSZXN0YXVyYW50SFRNTCIsInNvdXJjZU1lZGl1bSIsIm1lZGlhIiwic3Jjc2V0IiwiaW1hZ2VVcmxGb3JSZXN0YXVyYW50Iiwic2l6ZSIsInR5cGUiLCJwaWN0dXJlIiwiYXBwZW5kQ2hpbGQiLCJzb3VyY2VTbWFsbCIsImltYWdlIiwiY2xhc3NOYW1lIiwic3JjIiwic2luZ2xlVmFsdWUiLCJuYW1lIiwic3BhbiIsImFkZHJlc3MiLCJtb3JlIiwiY29uY2F0IiwidXJsRm9yUmVzdGF1cmFudCIsIm1hcE1hcmtlckZvclJlc3RhdXJhbnQiLCJvbiIsIndpbmRvdyIsImxvY2F0aW9uIiwiaHJlZiIsIm9wdGlvbnMiLCJ1cmwiLCJwdXNoIl0sIm1hcHBpbmdzIjoiYUFBQSxJQUFJQSxZQUNBQyxjQURBRCxTQUNBQyxPQUNBQyxRQUFKLEdBT0FDLFNBQVNDLGlCQUFpQixtQkFBb0IsU0FBQ0MsR0FDN0NDLFVBREZILHFCQUNFRyxnQkFDQUMsd0JBRUFDLE9BQUFBLFFBR0VDLFlBQVlDLHNCQUF1QixPQU92QyxJQUFNSCxtQkFBcUIsV0FDekJJLFNBQVNKLG1CQUFtQixTQUFDSyxFQUFPWCxHQURoQ00sRUFDSkksUUFBU0osTUFBQUEsSUFDTU0sS0FBQVosY0FBQUEsRUFDWGEsNEJBV0FDLHNCQUF3QixXQUF3QyxJQUF2Q2QsRUFBdUMsRUFBQWUsVUFBQUMsYUFBQUMsSUFBQUYsVUFBQSxHQUFBQSxVQUFBLEdBQXZCSCxLQUFLWixjQUM1Q2tCLEVBQVNoQixTQUFTaUIsZUFBZSx3QkFDdkNuQixFQUFjb0IsUUFBUSxTQUFDQyxHQUNyQixJQUFNQyxFQUFTcEIsU0FBU3FCLGNBQWMsVUFIcENULEVBQUFBLFVBQUFBLEVBQWdFUSxFQUF2Q3RCLE1BQXVDcUIsRUFDcEVILEVBQU1BLE9BQVNoQixNQURqQnNCLGNBQUEsV0FVQWQsU0FBQWMsY0FBQSxTQUFBYixFQUFBVixHQUtRVSxFQUNGRSxRQUFRRixNQUFNQSxJQUVkQyxLQUFLWCxTQUFXQSxFQUxoQnVCLHVCQU9EQyxpQkFBQSxXQUFBLElBQUF4QixFQUFBLEVBQUFjLFVBQUFDLGFBQUFDLElBQUFGLFVBQUEsR0FBQUEsVUFBQSxHQUFBSCxLQUFBWCxTQU5IaUIsRUFBQWhCLFNBQUFpQixlQUFBLG1CQURGbEIsRUFBQW1CLFFBQUEsU0FBQU0sR0FXQSxJQUFBSixFQUFBcEIsU0FBQXFCLGNBQUEsVUFPSUQsRUFBT0ssVUFBWUQs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ekMsS0FBQUEsU0FBWXdCLGlCQUFqQkEsR0FDQWtCLEVBQUt4QyxPQUFPdUMsR0FHWi9DLEVBQUFBLE9BQWFNLEdBR1AyQyxHQU9GbEIsZ0JBQWlCcUIsWUFBckIsRUFBQTFELFVBQUFDLGFBQUFDLElBQUFGLFVBQUEsR0FBQUEsVUFBQSxHQUFZSCxLQUEwQnVDLGFBQzFCb0IsUUFBWixTQUFBcEIsR0FJQSxJQUFPRSxFQUFQM0MsU0FBQWdFLHVCQUFBdkIsRUFBQXZDLEtBQUF5QixRQXBERlUsRUFBQTRCLEdBQUEsUUF1REEsV0FTTUMsT0FBT0MsU0FBU0MsS0FBTy9CLEVBQU9nQyxRQUFRQyxNQUV4Q3BFLEtBQUtrQyxRQUFRbUMsS0FBS2xDIiwiZmlsZSI6Im1haW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJsZXQgcmVzdGF1cmFudHM7XG5sZXQgbmVpZ2hib3Job29kcztcbmxldCBjdWlzaW5lcztcbmxldCBuZXdNYXA7XG5jb25zdCBtYXJrZXJzID0gW107XG5cbi8qKlxuICogRmV0Y2ggbmVpZ2hib3Job29kcyBhbmQgY3Vpc2luZXMgYXMgc29vbiBhcyB0aGUgcGFnZSBpcyBsb2FkZWQuXG4gKi9cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCAoZXZlbnQpID0+IHtcbiAgaW5pdE1hcCgpO1xuICBmZXRjaE5laWdoYm9yaG9vZHMoKTtcbiAgZmV0Y2hDdWlzaW5lcygpO1xuICByZWdpc3RlclNlcnZpY2VXb3JrZXIoKTtcblxuICBpZiAod2luZG93LmNhY2hlcykge1xuICAgIHNldEludGVydmFsKGNsZWFuTWFwYm94VGlsZXNDYWNoZSwgNTAwMCk7XG4gIH1cbn0pO1xuXG4vKipcbiAqIEZldGNoIGFsbCBuZWlnaGJvcmhvb2RzIGFuZCBzZXQgdGhlaXIgSFRNTC5cbiAqL1xuY29uc3QgZmV0Y2hOZWlnaGJvcmhvb2RzID0gKCkgPT4ge1xuICBEQkhlbHBlci5mZXRjaE5laWdoYm9yaG9vZHMoKGVycm9yLCBuZWlnaGJvcmhvb2RzKSA9PiB7XG4gICAgaWYgKGVycm9yKSB7IC8vIEdvdCBhbiBlcnJvclxuICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHNlbGYubmVpZ2hib3Job29kcyA9IG5laWdoYm9yaG9vZHM7XG4gICAgICBmaWxsTmVpZ2hib3Job29kc0hUTUwoKTtcbiAgICB9XG4gIH0pO1xufTtcblxuLyoqXG4gKiBTZXQgbmVpZ2hib3Job29kcyBIVE1MLlxuICovXG5jb25zdCBmaWxsTmVpZ2hib3Job29kc0hUTUwgPSAobmVpZ2hib3Job29kcyA9IHNlbGYubmVpZ2hib3Job29kcykgPT4ge1xuICBjb25zdCBzZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmVpZ2hib3Job29kcy1zZWxlY3QnKTtcbiAgbmVpZ2hib3Job29kcy5mb3JFYWNoKChuZWlnaGJvcmhvb2QpID0+IHtcbiAgICBjb25zdCBvcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKTtcbiAgICBvcHRpb24uaW5uZXJIVE1MID0gbmVpZ2hib3Job29kO1xuICAgIG9wdGlvbi52YWx1ZSA9IG5laWdoYm9yaG9vZDtcbiAgICBzZWxlY3QuYXBwZW5kKG9wdGlvbik7XG4gIH0pO1xufTtcblxuLyoqXG4gKiBGZXRjaCBhbGwgY3Vpc2luZXMgYW5kIHNldCB0aGVpciBIVE1MLlxuICovXG5jb25zdCBmZXRjaEN1aXNpbmVzID0gKCkgPT4ge1xuICBEQkhlbHBlci5mZXRjaEN1aXNpbmVzKChlcnJvciwgY3Vpc2luZXMpID0+IHtcbiAgICBpZiAoZXJyb3IpIHsgLy8gR290IGFuIGVycm9yIVxuICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHNlbGYuY3Vpc2luZXMgPSBjdWlzaW5lcztcbiAgICAgIGZpbGxDdWlzaW5lc0hUTUwoKTtcbiAgICB9XG4gIH0pO1xufTtcblxuLyoqXG4gKiBTZXQgY3Vpc2luZXMgSFRNTC5cbiAqL1xuY29uc3QgZmlsbEN1aXNpbmVzSFRNTCA9IChjdWlzaW5lcyA9IHNlbGYuY3Vpc2luZXMpID0+IHtcbiAgY29uc3Qgc2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2N1aXNpbmVzLXNlbGVjdCcpO1xuICBjdWlzaW5lcy5mb3JFYWNoKChjdWlzaW5lKSA9PiB7XG4gICAgY29uc3Qgb3B0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnb3B0aW9uJyk7XG4gICAgb3B0aW9uLmlubmVySFRNTCA9IGN1aXNpbmU7XG4gICAgb3B0aW9uLnZhbHVlID0gY3Vpc2luZTtcbiAgICBzZWxlY3QuYXBwZW5kKG9wdGlvbik7XG4gIH0pO1xufTtcblxuLyoqXG4gKiBJbml0aWFsaXplIGxlYWZsZXQgbWFwLCBjYWxsZWQgZnJvbSBIVE1MLlxuICovXG5jb25zdCBpbml0TWFwID0gKCkgPT4ge1xuICBjb25zdCBNQVBCT1hfQVBJX0tFWSA9ICdway5leUoxSWpvaVlXNWxaWE5oTFhOaGJHVm9JaXdpWVNJNkltTnFhMnhtWkhWd01ERm9ZVzR6ZG5Bd1lXcGxNbTUzYkhFaWZRLlYxMWRET3RFbldTd1R4WS1DOG1KTHcnO1xuICBzZWxmLm5ld01hcCA9IEwubWFwKCdtYXAnLCB7XG4gICAgY2VudGVyOiBbNDAuNzIyMjE2LCAtNzMuOTg3NTAxXSxcbiAgICB6b29tOiAxMixcbiAgICBzY3JvbGxXaGVlbFpvb206IGZhbHNlLFxuICB9KTtcbiAgTC50aWxlTGF5ZXIoJ2h0dHBzOi8vYXBpLnRpbGVzLm1hcGJveC5jb20vdjQve2lkfS97en0ve3h9L3t5fS5qcGc3MD9hY2Nlc3NfdG9rZW49e21hcGJveFRva2VufScsIHtcbiAgICBtYXBib3hUb2tlbjogTUFQQk9YX0FQSV9LRVksXG4gICAgbWF4Wm9vbTogMTgsXG4gICAgYXR0cmlidXRpb246ICdNYXAgZGF0YSAmY29weTsgPGEgaHJlZj1cImh0dHBzOi8vd3d3Lm9wZW5zdHJlZXRtYXAub3JnL1wiPk9wZW5TdHJlZXRNYXA8L2E+IGNvbnRyaWJ1dG9ycywgJ1xuICAgICAgKyAnPGEgaHJlZj1cImh0dHBzOi8vY3JlYXRpdmVjb21tb25zLm9yZy9saWNlbnNlcy9ieS1zYS8yLjAvXCI+Q0MtQlktU0E8L2E+LCAnXG4gICAgICArICdJbWFnZXJ5IMKpIDxhIGhyZWY9XCJodHRwczovL3d3dy5tYXBib3guY29tL1wiPk1hcGJveDwvYT4nLFxuICAgIGlkOiAnbWFwYm94LnN0cmVldHMnLFxuICB9KS5hZGRUbyhuZXdNYXApO1xuXG4gIHVwZGF0ZVJlc3RhdXJhbnRzKCk7XG59O1xuXG4vKipcbiAqIFVwZGF0ZSBwYWdlIGFuZCBtYXAgZm9yIGN1cnJlbnQgcmVzdGF1cmFudHMuXG4gKi9cbmNvbnN0IHVwZGF0ZVJlc3RhdXJhbnRzID0gKCkgPT4ge1xuICBjb25zdCBjU2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2N1aXNpbmVzLXNlbGVjdCcpO1xuICBjb25zdCBuU2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25laWdoYm9yaG9vZHMtc2VsZWN0Jyk7XG5cbiAgY29uc3QgY0luZGV4ID0gY1NlbGVjdC5zZWxlY3RlZEluZGV4O1xuICBjb25zdCBuSW5kZXggPSBuU2VsZWN0LnNlbGVjdGVkSW5kZXg7XG5cbiAgY29uc3QgY3Vpc2luZSA9IGNTZWxlY3RbY0luZGV4XS52YWx1ZTtcbiAgY29uc3QgbmVpZ2hib3Job29kID0gblNlbGVjdFtuSW5kZXhdLnZhbHVlO1xuXG4gIERCSGVscGVyLmZldGNoUmVzdGF1cmFudEJ5Q3Vpc2luZUFuZE5laWdoYm9yaG9vZChjdWlzaW5lLCBuZWlnaGJvcmhvb2QsIChlcnJvciwgcmVzdGF1cmFudHMpID0+IHtcbiAgICBpZiAoZXJyb3IpIHsgLy8gR290IGFuIGVycm9yIVxuICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJlc2V0UmVzdGF1cmFudHMocmVzdGF1cmFudHMpO1xuICAgICAgZmlsbFJlc3RhdXJhbnRzSFRNTCgpO1xuICAgIH1cbiAgfSk7XG59O1xuXG4vKipcbiAqIENsZWFyIGN1cnJlbnQgcmVzdGF1cmFudHMsIHRoZWlyIEhUTUwgYW5kIHJlbW92ZSB0aGVpciBtYXAgbWFya2Vycy5cbiAqL1xuY29uc3QgcmVzZXRSZXN0YXVyYW50cyA9IChyZXN0YXVyYW50cykgPT4ge1xuICAvLyBSZW1vdmUgYWxsIHJlc3RhdXJhbnRzXG4gIHNlbGYucmVzdGF1cmFudHMgPSBbXTtcbiAgY29uc3QgdWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudHMtbGlzdCcpO1xuICB1bC5pbm5lckhUTUwgPSAnJztcblxuICAvLyBSZW1vdmUgYWxsIG1hcCBtYXJrZXJzXG4gIGlmIChzZWxmLm1hcmtlcnMpIHtcbiAgICBzZWxmLm1hcmtlcnMuZm9yRWFjaChtYXJrZXIgPT4gbWFya2VyLnJlbW92ZSgpKTtcbiAgfVxuICBzZWxmLm1hcmtlcnMgPSBbXTtcbiAgc2VsZi5yZXN0YXVyYW50cyA9IHJlc3RhdXJhbnRzO1xufTtcblxuLyoqXG4gKiBDcmVhdGUgYWxsIHJlc3RhdXJhbnRzIEhUTUwgYW5kIGFkZCB0aGVtIHRvIHRoZSB3ZWJwYWdlLlxuICovXG5jb25zdCBmaWxsUmVzdGF1cmFudHNIVE1MID0gKHJlc3RhdXJhbnRzID0gc2VsZi5yZXN0YXVyYW50cykgPT4ge1xuICBjb25zdCB1bCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50cy1saXN0Jyk7XG4gIHJlc3RhdXJhbnRzLmZvckVhY2goKHJlc3RhdXJhbnQpID0+IHtcbiAgICB1bC5hcHBlbmQoY3JlYXRlUmVzdGF1cmFudEhUTUwocmVzdGF1cmFudCkpO1xuICB9KTtcbiAgYWRkTWFya2Vyc1RvTWFwKCk7XG59O1xuXG4vKipcbiAqIENyZWF0ZSByZXN0YXVyYW50IEhUTUwuXG4gKi9cbmNvbnN0IGNyZWF0ZVJlc3RhdXJhbnRIVE1MID0gKHJlc3RhdXJhbnQpID0+IHtcbiAgY29uc3QgYXJ0aWNsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2FydGljbGUnKTtcblxuICBjb25zdCBwaWN0dXJlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncGljdHVyZScpO1xuXG4gIC8vIGEgdHdvLWNvbHVtbiBsYXlvdXQgaXMgdXNlZCBmb3IgbGFyZ2VyIHZpZXdwb3J0c1xuICAvLyBtZWRpdW0gaW1hZ2VzIGFyZSBkaXNwbGF5ZWQgZm9yIHdpZGUgc2luZ2xlLWNvbHVtbiAoNDUxcHggLSA3NDlweCkgYW5kIHdpZGUgMi1jb2x1bW4gdmlld3BvcnRzICg+PSA5NTBweClcbiAgY29uc3Qgc291cmNlTWVkaXVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc291cmNlJyk7XG4gIHNvdXJjZU1lZGl1bS5tZWRpYSA9ICcobWluLXdpZHRoOiA0NTFweCkgYW5kIChtYXgtd2lkdGg6IDc0OXB4KSwgKG1pbi13aWR0aDogOTUwcHgpJztcbiAgc291cmNlTWVkaXVtLnNyY3NldCA9IERCSGVscGVyLmltYWdlVXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50LCB7IHNpemU6ICdtZWRpdW0nIH0pO1xuICBzb3VyY2VNZWRpdW0udHlwZSA9ICdpbWFnZS9qcGVnJztcbiAgcGljdHVyZS5hcHBlbmRDaGlsZChzb3VyY2VNZWRpdW0pO1xuXG4gIC8vIHNtYWxsIGltYWdlcyBhcmUgZGlzcGxheWVkIGZvciBzbWFsbCBzaW5nbGUtY29sdW1uICg8PSA0NTBweCkgYW5kIHNtYWxsIDItY29sdW1uIHZpZXdwb3J0cyAoNzUwcHggLSA5NDlweClcbiAgY29uc3Qgc291cmNlU21hbGwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzb3VyY2UnKTtcbiAgc291cmNlU21hbGwubWVkaWEgPSAnKG1heC13aWR0aDogNDUwcHgpLCAobWluLXdpZHRoOiA3NTBweCkgYW5kIChtYXgtd2lkdGg6IDk0OXB4KSc7XG4gIHNvdXJjZVNtYWxsLnNyY3NldCA9IERCSGVscGVyLmltYWdlVXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50LCB7IHNpemU6ICdzbWFsbCcgfSk7XG4gIHNvdXJjZVNtYWxsLnR5cGUgPSAnaW1hZ2UvanBlZyc7XG4gIHBpY3R1cmUuYXBwZW5kQ2hpbGQoc291cmNlU21hbGwpO1xuXG4gIGNvbnN0IGltYWdlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW1nJyk7XG4gIGltYWdlLmNsYXNzTmFtZSA9ICdyZXN0YXVyYW50LWltZyc7XG4gIC8vIHNldCBkZWZhdWx0IHNpemUgaW4gY2FzZSBwaWN0dXJlIGVsZW1lbnQgaXMgbm90IHN1cHBvcnRlZFxuICBpbWFnZS5zcmNzZXQgPSBEQkhlbHBlci5pbWFnZVVybEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCwgeyBzaXplOiAnbWVkaXVtJyB9KTtcbiAgaW1hZ2Uuc3JjID0gREJIZWxwZXIuaW1hZ2VVcmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQsIHsgc2l6ZTogJ21lZGl1bScsIHNpbmdsZVZhbHVlOiB0cnVlIH0pO1xuICBpbWFnZS5hbHQgPSByZXN0YXVyYW50LmFsdDtcbiAgcGljdHVyZS5hcHBlbmRDaGlsZChpbWFnZSk7XG5cbiAgYXJ0aWNsZS5hcHBlbmQocGljdHVyZSk7XG5cbiAgY29uc3Qgc3BhbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcblxuICBjb25zdCBuYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaDInKTtcbiAgbmFtZS5pbm5lckhUTUwgPSByZXN0YXVyYW50Lm5hbWU7XG4gIHNwYW4uYXBwZW5kKG5hbWUpO1xuXG4gIGNvbnN0IG5laWdoYm9yaG9vZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcbiAgbmVpZ2hib3Job29kLmlubmVySFRNTCA9IHJlc3RhdXJhbnQubmVpZ2hib3Job29kO1xuICBzcGFuLmFwcGVuZChuZWlnaGJvcmhvb2QpO1xuXG4gIGNvbnN0IGFkZHJlc3MgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XG4gIGFkZHJlc3MuaW5uZXJIVE1MID0gcmVzdGF1cmFudC5hZGRyZXNzO1xuICBzcGFuLmFwcGVuZChhZGRyZXNzKTtcblxuICBjb25zdCBtb3JlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xuICBtb3JlLmlubmVySFRNTCA9ICdWaWV3IERldGFpbHMnO1xuICBtb3JlLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsIGBWaWV3IERldGFpbHMgb2YgJHtyZXN0YXVyYW50Lm5hbWV9YCk7XG4gIG1vcmUuaHJlZiA9IERCSGVscGVyLnVybEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCk7XG4gIHNwYW4uYXBwZW5kKG1vcmUpO1xuXG4gIGFydGljbGUuYXBwZW5kKHNwYW4pO1xuXG4gIHJldHVybiBhcnRpY2xlO1xufTtcblxuLyoqXG4gKiBBZGQgbWFya2VycyBmb3IgY3VycmVudCByZXN0YXVyYW50cyB0byB0aGUgbWFwLlxuICovXG5jb25zdCBhZGRNYXJrZXJzVG9NYXAgPSAocmVzdGF1cmFudHMgPSBzZWxmLnJlc3RhdXJhbnRzKSA9PiB7XG4gIHJlc3RhdXJhbnRzLmZvckVhY2goKHJlc3RhdXJhbnQpID0+IHtcbiAgICAvLyBBZGQgbWFya2VyIHRvIHRoZSBtYXBcbiAgICBjb25zdCBtYXJrZXIgPSBEQkhlbHBlci5tYXBNYXJrZXJGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQsIHNlbGYubmV3TWFwKTtcbiAgICBtYXJrZXIub24oJ2NsaWNrJywgb25DbGljayk7XG4gICAgZnVuY3Rpb24gb25DbGljaygpIHtcbiAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gbWFya2VyLm9wdGlvbnMudXJsO1xuICAgIH1cbiAgICBzZWxmLm1hcmtlcnMucHVzaChtYXJrZXIpO1xuICB9KTtcbn07XG4iXX0=
